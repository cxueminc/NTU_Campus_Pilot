"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["502"],{12264:function(e,t,i){i.r(t),i.d(t,{PaymentAttemptPage:()=>z,PaymentAttemptsList:()=>d});var o=i(73312),n=i(16600),a=i(39082),r=i(55913),l=i(11576),c=i(64204),s=i(24676);let d=()=>{let{data:e,isLoading:t,count:i}=(0,l.usePaymentAttempts)(),a=(0,l.useSubscriberTypeLocalizationRoot)();return(0,o.tZ)(n.wQ,{page:1,onPageChange:e=>{},itemCount:i,pageCount:1,itemsPerPage:10,isLoading:t,emptyStateLocalizationKey:(0,c.localizationKeys)("".concat(a,".billingPage.paymentHistorySection.empty")),headers:[(0,c.localizationKeys)("".concat(a,".billingPage.paymentHistorySection.tableHeader__date")),(0,c.localizationKeys)("".concat(a,".billingPage.paymentHistorySection.tableHeader__amount")),(0,c.localizationKeys)("".concat(a,".billingPage.paymentHistorySection.tableHeader__status"))],rows:e.map(e=>(0,o.tZ)(p,{paymentAttempt:e},e.id))})},p=e=>{let{paymentAttempt:t}=e,{id:i,amount:l,failedAt:d,paidAt:p,updatedAt:u,status:h}=t,{navigate:m}=(0,s.useRouter)();return(0,o.BX)(n.Uk,{onClick:()=>{m("payment-attempt/".concat(i))},children:[(0,o.BX)(c.Td,{sx:{cursor:"pointer"},children:[(0,o.tZ)(c.Text,{variant:"subtitle",children:(0,a.p)(p||d||u,"long")}),(0,o.tZ)(c.Text,{colorScheme:"secondary",variant:"caption",truncate:!0,sx:e=>({marginTop:e.space.$0x5}),children:(0,r.L)(i)})]}),(0,o.tZ)(c.Td,{sx:{cursor:"pointer"},children:(0,o.BX)(c.Text,{children:[l.currencySymbol,l.amountFormatted]})}),(0,o.tZ)(c.Td,{children:(0,o.tZ)(c.Badge,{colorScheme:"paid"===h?"success":"failed"===h?"danger":"primary",sx:{textTransform:"capitalize"},children:h})})]})};i(45261),i(70957),i(24551),i(22349),i(65223);var u=i(83799),h=i(7901),m=i(9117),y=i(92654),g=i(28e3),b=i(276),x=i(96352),Z=i(96519);let z=()=>{let{params:e,navigate:t}=(0,s.useRouter)(),i=(0,b.sC)(),{organization:n}=(0,u.o8)(),l=(0,b.xr)(),{t:d,translateError:p}=(0,c.useLocalizations)(),g=(0,u.cL)(),{data:x,isLoading:Z,error:z}=(0,h.default)(e.paymentAttemptId?{type:"payment-attempt",id:e.paymentAttemptId,orgId:"organization"===i?null==n?void 0:n.id:void 0}:null,()=>g.billing.getPaymentAttempt({id:e.paymentAttemptId,orgId:"organization"===i?null==n?void 0:n.id:void 0})),S=null==x?void 0:x.subscriptionItem;return Z?(0,o.tZ)(c.Box,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,o.tZ)(c.Spinner,{colorScheme:"primary",sx:{margin:"auto",display:"block"},elementDescriptor:c.descriptors.spinner})}):(0,o.BX)(o.HY,{children:[(0,o.tZ)(y.h.Root,{sx:e=>({borderBlockEndWidth:e.borderWidths.$normal,borderBlockEndStyle:e.borderStyles.$solid,borderBlockEndColor:e.colors.$borderAlpha100,marginBlockEnd:e.space.$4,paddingBlockEnd:e.space.$4}),children:(0,o.tZ)(y.h.BackLink,{onClick:()=>void t("../../",{searchParams:new URLSearchParams("tab=payments")}),children:(0,o.tZ)(y.h.Title,{localizationKey:(0,c.localizationKeys)("".concat(l,".billingPage.start.headerTitle__payments")),textVariant:"h2"})})}),x?(0,o.BX)(c.Box,{elementDescriptor:c.descriptors.paymentAttemptRoot,as:"article",sx:e=>({borderWidth:e.borderWidths.$normal,borderStyle:e.borderStyles.$solid,borderColor:e.colors.$borderAlpha100,borderRadius:e.radii.$lg,overflow:"clip"}),children:[(0,o.BX)(c.Box,{elementDescriptor:c.descriptors.paymentAttemptHeader,as:"header",sx:e=>({padding:e.space.$4,background:e.colors.$neutralAlpha25,display:"flex",justifyContent:"space-between",alignItems:"flex-start"}),children:[(0,o.BX)(c.Span,{elementDescriptor:c.descriptors.paymentAttemptHeaderTitleContainer,children:[(0,o.tZ)(c.Heading,{elementDescriptor:c.descriptors.paymentAttemptHeaderTitle,textVariant:"h2",localizationKey:(0,a.p)(x.paidAt||x.failedAt||x.updatedAt,"long")}),(0,o.BX)(c.Span,{sx:e=>({display:"flex",alignItems:"center",gap:e.space.$0x25,color:e.colors.$colorMutedForeground}),children:[(0,o.tZ)(v,{copyLabel:"Copy payment attempt ID",text:x.id}),(0,o.tZ)(c.Text,{colorScheme:"secondary",variant:"subtitle",children:(0,r.L)(x.id)})]})]}),(0,o.tZ)(c.Badge,{elementDescriptor:c.descriptors.paymentAttemptHeaderBadge,colorScheme:"paid"===x.status?"success":"failed"===x.status?"danger":"primary",sx:{textTransform:"capitalize"},children:x.status})]}),(0,o.tZ)(f,{subscriptionItem:S}),(0,o.BX)(c.Box,{elementDescriptor:c.descriptors.paymentAttemptFooter,as:"footer",sx:e=>({paddingInline:e.space.$4,paddingBlock:e.space.$3,background:e.colors.$neutralAlpha25,borderBlockStartWidth:e.borderWidths.$normal,borderBlockStartStyle:e.borderStyles.$solid,borderBlockStartColor:e.colors.$borderAlpha100,display:"flex",justifyContent:"space-between"}),children:[(0,o.tZ)(c.Text,{variant:"h3",localizationKey:(0,c.localizationKeys)("billing.totalDue"),elementDescriptor:c.descriptors.paymentAttemptFooterLabel}),(0,o.BX)(c.Span,{elementDescriptor:c.descriptors.paymentAttemptFooterValueContainer,sx:e=>({display:"flex",alignItems:"center",gap:e.space.$2x5}),children:[(0,o.tZ)(c.Text,{variant:"caption",colorScheme:"secondary",elementDescriptor:c.descriptors.paymentAttemptFooterCurrency,sx:{textTransform:"uppercase"},children:x.amount.currency}),(0,o.BX)(c.Text,{variant:"h3",elementDescriptor:c.descriptors.paymentAttemptFooterValue,children:[x.amount.currencySymbol,x.amount.amountFormatted]})]})]})]}):(0,o.tZ)(c.Box,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,o.tZ)(m.b,{variant:"danger",colorScheme:"danger",children:z?p(z.errors[0]):d((0,c.localizationKeys)("".concat(l,".billingPage.paymentHistorySection.notFound")))})})]})};function f(e){var t,i;let{subscriptionItem:n}=e;if(!n)return null;let a="month"===n.planPeriod?n.plan.fee:n.plan.annualMonthlyFee;return(0,o.tZ)(c.Box,{elementDescriptor:c.descriptors.paymentAttemptBody,sx:e=>({padding:e.space.$4}),children:(0,o.BX)(g.a.Root,{children:[(0,o.BX)(g.a.Group,{children:[(0,o.tZ)(g.a.Title,{title:n.plan.name}),(0,o.tZ)(g.a.Description,{prefix:"annual"===n.planPeriod?"x12":void 0,text:"".concat(a.currencySymbol).concat(a.amountFormatted)})]}),(0,o.BX)(g.a.Group,{borderTop:!0,variant:"tertiary",children:[(0,o.tZ)(g.a.Title,{title:(0,c.localizationKeys)("billing.subtotal")}),(0,o.tZ)(g.a.Description,{text:"".concat(null==(t=n.amount)?void 0:t.currencySymbol).concat(null==(i=n.amount)?void 0:i.amountFormatted)})]}),n.credit&&n.credit.amount.amount>0&&(0,o.BX)(g.a.Group,{variant:"tertiary",children:[(0,o.tZ)(g.a.Title,{title:(0,c.localizationKeys)("billing.credit")}),(0,o.tZ)(g.a.Description,{text:"- ".concat(n.credit.amount.currencySymbol).concat(n.credit.amount.amountFormatted)})]})]})})}function v(e){let{text:t,copyLabel:i="Copy"}=e,{onCopy:n,hasCopied:a}=(0,x.VP)(t);return(0,o.tZ)(c.Button,{elementDescriptor:c.descriptors.paymentAttemptCopyButton,variant:"unstyled",onClick:n,sx:e=>({color:"inherit",width:e.sizes.$4,height:e.sizes.$4,padding:0,borderRadius:e.radii.$sm,"&:focus-visible":{outline:"2px solid",outlineColor:e.colors.$colorRing}}),focusRing:!1,"aria-label":a?"Copied":i,children:(0,o.tZ)(c.Icon,{size:"sm",icon:a?Z.Jr:Z.CK,"aria-hidden":!0})})}},74557:function(e,t,i){i.d(t,{hG:()=>M,ph:()=>T,fC:()=>B,OL:()=>w}),i(65223);var o=i(73312),n=i(83799),a=i(69144),r=i(92418),l=i(2672),c=i(70431),s=i(19460),d=i(68487),p=i(68849),u=i(88870),h=i(11576),m=i(64204);let y=e=>(0,o.tZ)(m.Box,{sx:[e=>({height:e.space.$2,width:"100%",borderRadius:e.radii.$md,background:e.colors.$neutralAlpha100}),e.sx]}),g=()=>(0,o.tZ)(y,{sx:e=>({height:e.space.$10,width:"100%"})}),b=e=>(0,o.tZ)(m.Flex,{direction:"col",gap:2,children:e.children}),x=()=>(0,o.tZ)(m.Box,{"aria-label":"Loading...",sx:{position:"relative",minHeight:0,flex:1,overflowY:"auto"},children:(0,o.BX)(m.Flex,{direction:"col",gap:5,children:[(0,o.BX)(b,{children:[(0,o.tZ)(y,{sx:e=>({height:e.space.$3,width:e.sizes.$24})}),(0,o.tZ)(g,{})]}),(0,o.BX)(m.Grid,{columns:2,gap:4,children:[(0,o.BX)(b,{children:[(0,o.tZ)(y,{sx:e=>({height:e.space.$3,width:e.sizes.$20})}),(0,o.tZ)(g,{})]}),(0,o.BX)(b,{children:[(0,o.tZ)(y,{sx:e=>({height:e.space.$3,width:e.sizes.$24})}),(0,o.tZ)(g,{})]})]}),(0,o.BX)(b,{children:[(0,o.tZ)(y,{sx:e=>({height:e.space.$3,width:e.sizes.$16})}),(0,o.tZ)(g,{})]}),(0,o.BX)(b,{children:[(0,o.tZ)(y,{}),(0,o.tZ)(y,{}),(0,o.tZ)(y,{sx:{width:"66.666667%"}})]})]})}),[Z,z]=(0,n.uH)("AddPaymentMethodRoot"),f=e=>{let{children:t,checkout:i,...r}=e,l=(0,h.useSubscriberTypeContext)(),c=(0,a.useRef)(null),{t:s}=(0,m.useLocalizations)(),[d,u]=(0,a.useState)(void 0),[y,g]=(0,a.useState)(void 0),[b,x]=(0,a.useState)(void 0),z=(e=>{let t=(0,m.useAppearance)().parsedInternalTheme;return(0,a.useMemo)(()=>{if(!e)return;let{colors:i,fontWeights:o,fontSizes:n,radii:a,space:r}=t;return{colorPrimary:(0,p.Aj)(e,i.$primary500,i.$colorBackground),colorBackground:(0,p.Aj)(e,i.$colorInput,i.$colorBackground),colorText:(0,p.Aj)(e,i.$colorForeground,i.$colorBackground),colorTextSecondary:(0,p.Aj)(e,i.$colorMutedForeground,i.$colorBackground),colorSuccess:(0,p.Aj)(e,i.$success500,i.$colorBackground),colorDanger:(0,p.Aj)(e,i.$danger500,i.$colorBackground),colorWarning:(0,p.Aj)(e,i.$warning500,i.$colorBackground),fontWeightNormal:(0,p.uj)(e,"font-weight",o.$normal.toString()),fontWeightMedium:(0,p.uj)(e,"font-weight",o.$medium.toString()),fontWeightBold:(0,p.uj)(e,"font-weight",o.$bold.toString()),fontSizeXl:(0,p.uj)(e,"font-size",n.$xl),fontSizeLg:(0,p.uj)(e,"font-size",n.$lg),fontSizeSm:(0,p.uj)(e,"font-size",n.$md),fontSizeXs:(0,p.uj)(e,"font-size",n.$sm),borderRadius:(0,p.uj)(e,"border-radius",a.$lg),spacingUnit:(0,p.uj)(e,"padding",r.$1)}},[t,e])})(c.current);return(0,o.BX)(Z.Provider,{value:{value:{headerTitle:d,headerSubtitle:y,submitLabel:b,setHeaderTitle:u,setHeaderSubtitle:g,setSubmitLabel:x,checkout:i,...r}},children:[(0,o.tZ)("div",{ref:c,style:{display:"none"}}),(0,o.tZ)(n.pe,{checkout:i,for:l,stripeAppearance:z,paymentDescription:s((0,m.localizationKeys)((null==i?void 0:i.planPeriod)==="month"?"billing.paymentMethod.applePayDescription.monthly":"billing.paymentMethod.applePayDescription.annual")),children:t})]})},v=e=>{let{isProviderReady:t}=(0,n.Wh)();return t?null:e.children},S=e=>{let{isProviderReady:t}=(0,n.Wh)();return t?(0,o.tZ)(o.HY,{children:e.children}):null},B=e=>{let{children:t,...i}=e;return(0,o.BX)(f,{...i,children:[(0,o.tZ)(v,{children:(0,o.tZ)(m.Flex,{direction:"row",align:"center",justify:"center",sx:e=>({width:"100%",minHeight:e.sizes.$60}),children:(0,o.tZ)(m.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:m.descriptors.spinner})})}),(0,o.tZ)(S,{children:(0,o.tZ)(A,{children:t})})]})},$=(e,t)=>{(0,a.useRef)(()=>{t(e)}),(0,a.useEffect)(()=>{t(e)},[e,t])},T=e=>{let{text:t}=e,{setHeaderTitle:i}=z();return $(t,i),null},M=e=>{let{text:t}=e,{setHeaderSubtitle:i}=z();return $(t,i),null},w=e=>{let{text:t}=e,{setSubmitLabel:i}=z();return $(t,i),null},A=e=>{let{children:t}=e,{headerTitle:i,headerSubtitle:a,submitLabel:p,checkout:y,onSuccess:g,cancelAction:b}=z(),Z=(0,l.useCardState)(),f=(0,h.useSubscriberTypeLocalizationRoot)(),{isFormReady:v,submit:S,reset:B}=(0,n.Wh)(),$=async e=>{e.preventDefault(),Z.setLoading(),Z.setError(void 0);let{data:t,error:i}=await S();if(!i)try{await g(t)}catch(e){(0,u.S3)(e,[],Z.setError)}finally{Z.setIdle(),B()}};return(0,o.tZ)(d.Y,{headerTitle:i,headerSubtitle:a,children:(0,o.BX)(c.l.Root,{onSubmit:$,sx:e=>({display:"flex",flexDirection:"column",rowGap:e.space.$3}),children:[t,(0,o.tZ)(n.Y7,{fallback:(0,o.tZ)(x,{})}),(0,o.tZ)(r.Z.Alert,{children:Z.error}),(0,o.tZ)(s.A,{isDisabled:!v,submitLabel:null!=p?p:(0,m.localizationKeys)("".concat(f,".billingPage.paymentMethodsSection.formButtonPrimary__add")),onReset:b,hideReset:!b,sx:{flex:y?1:void 0}})]})})}},79176:function(e,t,i){i.d(t,{Q:()=>r});var o=i(73312),n=i(64204),a=i(96519);let r=e=>{let{paymentMethod:t}=e;return(0,o.BX)(n.Flex,{sx:{overflow:"hidden"},gap:2,align:"baseline",elementDescriptor:n.descriptors.paymentMethodRow,children:[(0,o.tZ)(n.Icon,{icon:"card"===t.paymentType?a.aB:a.Nn,sx:e=>({alignSelf:"center",color:e.colors.$colorMutedForeground}),elementDescriptor:n.descriptors.paymentMethodRowIcon}),(0,o.tZ)(n.Text,{sx:e=>({color:e.colors.$colorForeground,textTransform:"capitalize"}),truncate:!0,elementDescriptor:n.descriptors.paymentMethodRowType,children:"card"===t.paymentType?t.cardType:t.paymentType}),(0,o.tZ)(n.Text,{sx:e=>({color:e.colors.$colorMutedForeground}),variant:"caption",truncate:!0,elementDescriptor:n.descriptors.paymentMethodRowValue,children:"card"===t.paymentType?"⋯ ".concat(t.last4):null}),t.isDefault&&(0,o.tZ)(n.Badge,{elementDescriptor:n.descriptors.paymentMethodRowBadge,elementId:n.descriptors.paymentMethodRowBadge.setId("default"),localizationKey:(0,n.localizationKeys)("badge__default")}),"expired"===t.status&&(0,o.tZ)(n.Badge,{elementDescriptor:n.descriptors.paymentMethodRowBadge,elementId:n.descriptors.paymentMethodRowBadge.setId("expired"),colorScheme:"danger",localizationKey:(0,n.localizationKeys)("badge__expired")})]})}},11061:function(e,t,i){i.d(t,{A6:()=>S});var o=i(74557);i(50725),i(838);var n=i(73312),a=i(83799),r=i(69144),l=i(2672),c=i(58104),s=i(19655),d=i(33009),p=i(88870),u=i(79281),h=i(22189),m=i(11576),y=i(64204),g=i(99805),b=i(44709),x=i(79176),Z=i(28e3);let z=()=>{let{t:e}=(0,y.useLocalizations)();return(0,n.BX)(y.Box,{sx:e=>({background:e.colors.$neutralAlpha50,padding:e.space.$2x5,borderRadius:e.radii.$md,borderWidth:e.borderWidths.$normal,borderStyle:e.borderStyles.$solid,borderColor:e.colors.$borderAlpha100,display:"flex",flexDirection:"column",rowGap:e.space.$2,position:"relative"}),children:[(0,n.tZ)(y.Box,{sx:e=>({position:"absolute",inset:0,background:"repeating-linear-gradient(-45deg,".concat(e.colors.$warningAlpha100,",").concat(e.colors.$warningAlpha100," 6px,").concat(e.colors.$warningAlpha150," 6px,").concat(e.colors.$warningAlpha150," 12px)"),maskImage:"linear-gradient(transparent 20%, black)",pointerEvents:"none"})}),(0,n.BX)(y.Box,{sx:{display:"flex",alignItems:"baseline",justifyContent:"space-between"},children:[(0,n.tZ)(y.Text,{variant:"caption",colorScheme:"body",localizationKey:(0,y.localizationKeys)("billing.paymentMethod.dev.testCardInfo")}),(0,n.tZ)(y.Text,{variant:"caption",sx:e=>({color:e.colors.$warning500,fontWeight:e.fontWeights.$semibold}),localizationKey:(0,y.localizationKeys)("billing.paymentMethod.dev.developmentMode")})]}),(0,n.BX)(Z.a.Root,{children:[(0,n.BX)(Z.a.Group,{variant:"tertiary",children:[(0,n.tZ)(Z.a.Title,{title:(0,y.localizationKeys)("billing.paymentMethod.dev.cardNumber")}),(0,n.tZ)(Z.a.Description,{text:"4242 4242 4242 4242"})]}),(0,n.BX)(Z.a.Group,{variant:"tertiary",children:[(0,n.tZ)(Z.a.Title,{title:(0,y.localizationKeys)("billing.paymentMethod.dev.expirationDate")}),(0,n.tZ)(Z.a.Description,{text:"11/44"})]}),(0,n.BX)(Z.a.Group,{variant:"tertiary",children:[(0,n.tZ)(Z.a.Title,{title:(0,y.localizationKeys)("billing.paymentMethod.dev.cvcZip")}),(0,n.tZ)(Z.a.Description,{text:e((0,y.localizationKeys)("billing.paymentMethod.dev.anyNumbers"))})]})]})]})},f=(0,l.withCardStateProvider)(e=>{let{onSuccess:t}=e,{close:i}=(0,b.XC)(),r=(0,a.cL)(),l=(0,m.useSubscriberTypeContext)(),c=(0,m.useSubscriberTypeLocalizationRoot)(),s=async e=>{let o="organization"===l?null==r?void 0:r.organization:r.user;return await (null==o?void 0:o.addPaymentMethod(e)),t(),i(),Promise.resolve()};return(0,n.BX)(o.fC,{onSuccess:s,cancelAction:i,children:[(0,n.tZ)(o.ph,{text:(0,y.localizationKeys)("".concat(c,".billingPage.paymentMethodsSection.add"))}),(0,n.tZ)(o.hG,{text:(0,y.localizationKeys)("".concat(c,".billingPage.paymentMethodsSection.addSubtitle"))}),(0,n.tZ)(h.P,{children:(0,n.tZ)(z,{})})]})}),v=e=>{let{paymentMethod:t,revalidate:i}=e,{close:o}=(0,b.XC)(),c=(0,l.useCardState)(),s=(0,m.useSubscriberTypeContext)(),{organization:d}=(0,a.o8)(),h=(0,m.useSubscriberTypeLocalizationRoot)(),g=(0,r.useRef)("".concat("card"===t.paymentType?t.cardType:t.paymentType," ").concat("card"===t.paymentType?"⋯ ".concat(t.last4):"-"));if(!g.current)return null;let x=async()=>{await t.remove({orgId:"organization"===s?null==d?void 0:d.id:void 0}).then(i).catch(e=>{(0,p.S3)(e,[],c.setError)})};return(0,n.tZ)(u.LE,{title:(0,y.localizationKeys)("".concat(h,".billingPage.paymentMethodsSection.removeMethod.title")),messageLine1:(0,y.localizationKeys)("".concat(h,".billingPage.paymentMethodsSection.removeMethod.messageLine1"),{identifier:g.current}),messageLine2:(0,y.localizationKeys)("".concat(h,".billingPage.paymentMethodsSection.removeMethod.messageLine2")),successMessage:(0,y.localizationKeys)("".concat(h,".billingPage.paymentMethodsSection.removeMethod.successMessage"),{paymentMethod:g.current}),deleteResource:x,onSuccess:o,onReset:o})},S=(0,l.withCardStateProvider)(()=>{let e=(0,a.cL)(),t=(0,m.useSubscriberTypeContext)(),i=(0,m.useSubscriberTypeLocalizationRoot)(),o="organization"===t?null==e?void 0:e.organization:e.user,{data:l,isLoading:d,revalidate:p}=(0,m.usePaymentMethods)(),u=(0,r.useMemo)(()=>l.sort((e,t)=>e.isDefault&&!t.isDefault?-1:1),[l]);return o?(0,n.tZ)(s.zd.Root,{title:(0,y.localizationKeys)("".concat(i,".billingPage.paymentMethodsSection.title")),centered:!1,id:"paymentMethods",sx:e=>({flex:1,borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$borderAlpha100}),children:(0,n.tZ)(g.a.Root,{children:(0,n.tZ)(s.zd.ItemList,{id:"paymentMethods",disableAnimation:!0,children:d?(0,n.tZ)(c.m,{}):(0,n.BX)(n.HY,{children:[u.map(e=>(0,n.BX)(r.Fragment,{children:[(0,n.BX)(s.zd.Item,{id:"paymentMethods",children:[(0,n.tZ)(x.Q,{paymentMethod:e}),(0,n.tZ)(B,{paymentMethod:e,revalidate:p})]}),(0,n.tZ)(g.a.Open,{value:"remove-".concat(e.id),children:(0,n.tZ)(g.a.Card,{variant:"destructive",children:(0,n.tZ)(v,{paymentMethod:e,revalidate:p})})})]},e.id)),(0,n.BX)(n.HY,{children:[(0,n.tZ)(g.a.Trigger,{value:"add",children:(0,n.tZ)(s.zd.ArrowButton,{id:"paymentMethods",localizationKey:(0,y.localizationKeys)("".concat(i,".billingPage.paymentMethodsSection.add"))})}),(0,n.tZ)(g.a.Open,{value:"add",children:(0,n.tZ)(g.a.Card,{children:(0,n.tZ)(f,{onSuccess:p})})})]})]})})})}):null}),B=e=>{let{paymentMethod:t,revalidate:i}=e,{open:o}=(0,b.XC)(),r=(0,l.useCardState)(),{organization:c}=(0,a.o8)(),s=(0,m.useSubscriberTypeContext)(),u=(0,m.useSubscriberTypeLocalizationRoot)(),h=[{label:(0,y.localizationKeys)("".concat(u,".billingPage.paymentMethodsSection.actionLabel__remove")),isDestructive:!0,onClick:()=>o("remove-".concat(t.id)),isDisabled:!t.isRemovable}];return t.isDefault||h.unshift({label:(0,y.localizationKeys)("".concat(u,".billingPage.paymentMethodsSection.actionLabel__default")),isDestructive:!1,onClick:()=>{t.makeDefault({orgId:"organization"===s?null==c?void 0:c.id:void 0}).then(i).catch(e=>{(0,p.S3)(e,[],r.setError)})},isDisabled:!1}),(0,n.tZ)(d.a,{actions:h})}},95746:function(e,t,i){i.d(t,{u:()=>l});var o=i(73312),n=i(64204);let a={active:"badge__activePlan",upcoming:"badge__upcomingPlan",past_due:"badge__pastDuePlan",free_trial:"badge__freeTrial"},r={active:"secondary",upcoming:"primary",past_due:"warning",free_trial:"secondary"},l=e=>{let{subscription:t,elementDescriptor:i}=e;return(0,o.tZ)(n.Badge,{elementDescriptor:i,colorScheme:r[t.status],localizationKey:(0,n.localizationKeys)(a[t.status])})}},91800:function(e,t,i){i.d(t,{b:()=>u});var o=i(73312),n=i(69144),a=i(13559),r=i(19655),l=i(11576),c=i(64204),s=i(96519),d=i(24676),p=i(95746);function u(e){let{title:t,switchPlansLabel:i,newSubscriptionLabel:p,manageSubscriptionLabel:u}=e,m=(0,l.useSubscriberTypeLocalizationRoot)(),y=(0,l.useSubscriberTypeContext)(),{subscriptionItems:g}=(0,l.useSubscription)(),b=(0,a.N2)(e=>e({permission:"org:sys_billing:manage"}))||"user"===y,{navigate:x}=(0,d.useRouter)(),{commerceSettings:Z}=(0,l.useEnvironment)(),{openSubscriptionDetails:z}=(0,l.usePlansContext)(),f=Z.billing.user.hasPaidPlans&&"user"===y||Z.billing.organization.hasPaidPlans&&"organization"===y,v=(0,n.useMemo)(()=>g.some(e=>!e.plan.hasBaseFee&&"active"===e.status),[g]),S=b&&!v&&g.length>0,B=(0,n.useMemo)(()=>g.sort((e,t)=>"active"===e.status&&"active"!==t.status?-1:("active"===t.status&&e.status,1)),[g]);return(0,o.BX)(r.zd.Root,{id:"subscriptionsList",title:t,centered:!1,sx:e=>({borderTop:"none",paddingTop:e.space.$1}),children:[g.length>0&&(0,o.BX)(c.Table,{tableHeadVisuallyHidden:!0,children:[(0,o.tZ)(c.Thead,{children:(0,o.BX)(c.Tr,{children:[(0,o.tZ)(c.Th,{localizationKey:(0,c.localizationKeys)("".concat(m,".billingPage.subscriptionsListSection.tableHeader__plan"))}),(0,o.tZ)(c.Th,{localizationKey:(0,c.localizationKeys)("".concat(m,".billingPage.subscriptionsListSection.tableHeader__startDate"))})]})}),(0,o.tZ)(c.Tbody,{children:B.map(e=>(0,o.tZ)(h,{subscription:e,length:B.length},e.id))})]}),(0,o.BX)(r.zd.ButtonGroup,{id:"subscriptionsList",children:[f?(0,o.tZ)(r.zd.ArrowButton,{id:"subscriptionsList",textLocalizationKey:g.length>0?i:p,sx:[e=>({justifyContent:"start",height:e.sizes.$8,width:S?"unset":void 0})],leftIcon:g.length>0?s.Ic:s.v3,rightIcon:null,leftIconSx:e=>({width:e.sizes.$4,height:e.sizes.$4}),onClick:()=>void x("plans")}):null,S?(0,o.tZ)(r.zd.ArrowButton,{id:"subscriptionsList",textLocalizationKey:u,sx:[e=>({justifyContent:"start",height:e.sizes.$8,width:"unset"})],rightIcon:null,leftIcon:s.tc,leftIconSx:e=>({width:e.sizes.$4,height:e.sizes.$4}),onClick:e=>z(e)}):null]})]})}function h(e){let{subscription:t,length:i}=e,a="annual"===t.planPeriod?t.plan.annualFee:t.plan.fee,{captionForSubscription:r}=(0,l.usePlansContext)(),d=(0,n.useMemo)(()=>(0,l.normalizeFormatted)(a.amountFormatted),[a.amountFormatted]);return(0,o.BX)(c.Tr,{children:[(0,o.tZ)(c.Td,{children:(0,o.BX)(c.Col,{gap:1,children:[(0,o.BX)(c.Flex,{align:"center",gap:1,children:[(0,o.tZ)(c.Icon,{icon:s.ou,sx:e=>({width:e.sizes.$4,height:e.sizes.$4,opacity:e.opacity.$inactive})}),(0,o.tZ)(c.Text,{variant:"subtitle",sx:e=>({marginRight:e.sizes.$1}),children:t.plan.name}),t.isFreeTrial||i>1||t.canceledAt?(0,o.tZ)(p.u,{subscription:t.isFreeTrial?{status:"free_trial"}:t}):null]}),(!t.plan.isDefault||"upcoming"===t.status)&&(0,o.tZ)(c.Text,{variant:"caption",colorScheme:"secondary",localizationKey:r(t)})]})}),(0,o.tZ)(c.Td,{sx:e=>({textAlign:"right"}),children:(0,o.BX)(c.Text,{variant:"subtitle",children:[a.currencySymbol,d,a.amount>0&&(0,o.tZ)(c.Span,{sx:e=>({color:e.colors.$colorMutedForeground,textTransform:"lowercase",":before":{content:'"/"',marginInline:e.space.$1}}),localizationKey:"annual"===t.planPeriod?(0,c.localizationKeys)("billing.year"):(0,c.localizationKeys)("billing.month")})]})})]},t.id)}}}]);