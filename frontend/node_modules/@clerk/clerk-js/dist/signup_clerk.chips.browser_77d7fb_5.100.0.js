"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["710"],{5518:function(e,t,i){i.d(t,{Vh:()=>h,Vs:()=>g,bx:()=>p,mQ:()=>b,s2:()=>f,t3:()=>d,xT:()=>u}),i(5027);var r=i(2208),n=i(8690),a=i(7772),l=i(577);let o=e=>t=>"safeIdentifier"in t&&t.safeIdentifier===e;function s(e){if((0,r.iW)()){let t=e.find(({strategy:e})=>"passkey"===e);if(t)return t}return null}function d(e,t,i){return e&&0!==e.length?i===a.kJ.Password?function(e,t){let i=s(e);if(i)return i;let r=e.sort(l.sZ)[0];return"password"===r.strategy?r:e.find(o(t))||r||null}(e,t):function(e,t){let i=s(e);if(i)return i;let r=e.sort(l.b8),n=r.find(o(t));if(n)return n;let a=r[0];return"email_link"===a.strategy?a:e.find(o(t))||a||null}(e,t):null}let c=["passkey","email_code","password","phone_code","email_link"];function u(e){return!!e&&c.includes(e.strategy)}function p(e){if(!e||0===e.length)return null;let t=e.find(e=>"totp"===e.strategy);if(t)return t;let i=e.find(e=>"phone_code"===e.strategy);return i||e[0]}let m=["reset_password_phone_code","reset_password_email_code"],h=e=>!!e&&m.includes(e);function f(e){let t;return"tel"===e.type?"phoneNumber":(t=e.value,/^\S+@\S+\.\S+$/.test(t))?"emailAddress":"username"}let g=(e,t,i)=>{if(!t)return null;let r=e.find(e=>"strategy"===e.id)?.value;if(r&&"phone_code"!==r)return null;let a=e.find(e=>e.id===i)?.value;if(!a||!a?.startsWith("+"))return null;let l=(0,n.jR)(a,t);return"sms"===l?null:l},b=(e,t,i)=>{if(!e||!t||"phoneNumber"!==t||!i||!i?.startsWith("+"))return null;let r=(0,n.jR)(i,e);return"sms"===r?null:r}},7913:function(e,t,i){i.r(t),i.d(t,{SignUp:()=>eu,SignUpStart:()=>Q,SignUpContinue:()=>q,SignUpSSOCallback:()=>M,SignUpVerifyEmail:()=>el,SignUpVerifyPhone:()=>es,SignUpModal:()=>ep});var r=i(3312),n=i(3799),a=i(9144),l=i(4511),o=i(7508),s=i(5112),d=i(1576),c=i(4204),u=i(4676),p=i(2418),m=i(2672),h=i(2654),f=i(1455),g=i(8350),b=i(8870),_=i(6788),v=i(6127),y=i(431),S=i(8314),A=i(7321),U=i(1217);let C=e=>{let{handleSubmit:t,fields:i,formState:n,canToggleEmailPhone:a,onlyLegalAcceptedMissing:l=!1,handleEmailPhoneToggle:o}=e,{showOptionalFields:s}=(0,c.useAppearance)().parsedLayout,d=e=>("emailAddress"===e||"phoneNumber"===e)&&a?!!i[e]:!!i[e]&&(s||i[e]?.required);return(0,r.BX)(y.l.Root,{onSubmit:t,gap:8,children:[!l&&(0,r.BX)(c.Col,{gap:6,children:[(d("firstName")||d("lastName"))&&(0,r.BX)(y.l.ControlRow,{elementId:"name",sx:{[U.mqu.sm]:{flexWrap:"wrap"}},children:[d("firstName")&&(0,r.tZ)(y.l.PlainInput,{...n.firstName.props,isRequired:i.firstName?.required,isOptional:!i.firstName?.required}),d("lastName")&&(0,r.tZ)(y.l.PlainInput,{...n.lastName.props,isRequired:i.lastName?.required,isOptional:!i.lastName?.required})]}),d("username")&&(0,r.tZ)(y.l.ControlRow,{elementId:"username",children:(0,r.tZ)(y.l.PlainInput,{...n.username.props,isRequired:i.username?.required,isOptional:!i.username?.required})}),d("emailAddress")&&(0,r.tZ)(y.l.ControlRow,{elementId:"emailAddress",children:(0,r.tZ)(y.l.PlainInput,{...n.emailAddress.props,isRequired:i.emailAddress?.required,isOptional:!i.emailAddress?.required,isDisabled:i.emailAddress?.disabled,actionLabel:a?(0,c.localizationKeys)("signUp.start.actionLink__use_phone"):void 0,onActionClicked:a?()=>o("phoneNumber"):void 0})}),d("phoneNumber")&&(0,r.tZ)(y.l.ControlRow,{elementId:"phoneNumber",children:(0,r.tZ)(y.l.PhoneInput,{...n.phoneNumber.props,isRequired:i.phoneNumber?.required,isOptional:!i.phoneNumber?.required,actionLabel:a?(0,c.localizationKeys)("signUp.start.actionLink__use_email"):void 0,onActionClicked:a?()=>o("emailAddress"):void 0})}),d("password")&&(0,r.tZ)(y.l.ControlRow,{elementId:"password",children:(0,r.tZ)(y.l.PasswordInput,{...n.password.props,isRequired:i.password?.required,isOptional:!i.password?.required})})]}),(0,r.BX)(c.Col,{center:!0,children:[(0,r.tZ)(A.S,{}),(0,r.BX)(c.Col,{gap:6,sx:{width:"100%"},children:[d("legalAccepted")&&(0,r.tZ)(y.l.ControlRow,{elementId:"legalAccepted",children:(0,r.tZ)(S.H,{...n.legalAccepted.props,isRequired:i.legalAccepted?.required})}),(0,r.tZ)(y.l.SubmitButton,{hasArrow:!0,localizationKey:(0,c.localizationKeys)("formButtonPrimary")})]})]})]})};var Z=i(5027);let N=["emailAddress","phoneNumber","username","firstName","lastName","password","ticket","legalAccepted"];function P(e){return N.reduce((t,i)=>{let r=function(e,t){switch(e){case"emailAddress":return function({attributes:e,hasTicket:t,hasEmail:i,activeCommIdentifierType:r,isProgressiveSignUp:n}){if(n){if(!((!t||t&&i)&&e.email_address?.enabled)||E(e,n)&&"emailAddress"!==r)return;let{emailShouldBeRequired:a}=R(e);return{required:a,disabled:!!t&&!!i}}if((!t||t&&i)&&e.email_address?.enabled&&e.email_address?.used_for_first_factor&&"emailAddress"===r)return{required:!0,disabled:!!t&&!!i}}(t);case"phoneNumber":return function({attributes:e,hasTicket:t,activeCommIdentifierType:i,isProgressiveSignUp:r}){if(r){if(!e.phone_number?.enabled||E(e,r)&&"phoneNumber"!==i)return;let{phoneShouldBeRequired:t}=R(e);return{required:t}}if(!t&&e.phone_number?.enabled&&e.phone_number.used_for_first_factor&&"phoneNumber"===i)return{required:!0}}(t);case"password":var i=t.attributes;if(i.password?.enabled&&i.password.required)return{required:!!i.password?.required};return;case"ticket":var r=t.hasTicket;if(r)return{required:!0};return;case"legalAccepted":var n=t.legalConsentRequired;if(n)return{required:!0};return;case"username":case"firstName":case"lastName":var a=e,l=t.attributes;let o=(0,Z.a1)(a);if(l[o]?.enabled)return{required:l[o]?.required};return;default:return}}(i,e);return r&&(t[i]=r),t},{})}let w=(e,t,i)=>{if(i?.emailAddress)return"emailAddress";if(i?.phoneNumber)return"phoneNumber";if(E(e,t))return"emailAddress";let{email_address:r,phone_number:n}=e;return(r?.enabled&&t?r.required:r?.used_for_first_factor)?"emailAddress":(n?.enabled&&t?n.required:n?.used_for_first_factor)?"phoneNumber":null};function E(e,t){let{email_address:i,phone_number:r}=e;return!!(t?i?.enabled&&r?.enabled&&!i.required&&!r.required:i?.used_for_first_factor&&r?.used_for_first_factor)}let k={mirrorServer:[e=>!e.passwordRequired,e=>e.email.required||e.phone.required||e.username.required&&e.username.firstFactor],none:[e=>!e.email.enabled&&!e.phone.enabled&&!e.username.enabled],email:[e=>e.email.enabled&&!e.phone.enabled&&!e.username.enabled,e=>e.email.enabled&&!e.email.required&&e.phone.enabled&&!e.phone.required,e=>e.username.firstFactor&&!e.username.required&&e.email.enabled&&!e.email.required,e=>e.username.required&&!e.username.firstFactor&&e.email.enabled&&e.phone.enabled],phone:[e=>e.phone.enabled&&!e.email.required&&!e.phone.required,e=>e.username.firstFactor&&!e.username.required&&e.phone.enabled&&!e.phone.required,e=>e.phone.firstFactor&&!e.email.firstFactor&&!e.username.firstFactor,e=>e.username.required&&!e.username.firstFactor&&e.phone.enabled&&e.email.enabled,e=>!e.email.enabled&&e.phone.enabled&&e.username.enabled],username:[e=>e.username.enabled&&e.username.firstFactor&&!e.email.enabled&&!e.phone.enabled,e=>e.username.required&&!e.username.firstFactor&&e.email.enabled&&e.phone.enabled]};function R(e){let t={passwordRequired:!!(e.password?.enabled&&e.password.required),email:{enabled:!!e.email_address?.enabled,required:!!e.email_address?.required,firstFactor:!!e.email_address?.used_for_first_factor},phone:{enabled:!!e.phone_number?.enabled,required:!!e.phone_number?.required,firstFactor:!!e.phone_number?.used_for_first_factor},username:{enabled:!!e.username?.enabled,required:!!e.username?.required,firstFactor:!!e.username?.used_for_first_factor}},i=e=>k[e].some(e=>e(t));if(i("mirrorServer"))return{emailShouldBeRequired:t.email.required,phoneShouldBeRequired:t.phone.required,usernameShouldBeRequired:t.username.required};if(i("none"))return{emailShouldBeRequired:!1,phoneShouldBeRequired:!1,usernameShouldBeRequired:!1};let r=i("email"),n=i("phone"),a=i("username");return!t.passwordRequired||r||n||a?{emailShouldBeRequired:r,phoneShouldBeRequired:n,usernameShouldBeRequired:a}:{emailShouldBeRequired:!0,phoneShouldBeRequired:!1,usernameShouldBeRequired:!1}}var I=i(6565),z=i(9955),K=i(138);let F=a.memo(e=>{let t=(0,n.cL)(),{navigate:i}=(0,u.useRouter)(),a=(0,m.useCardState)(),l=(0,d.useSignUpContext)(),o=(0,d.useCoreSignUp)(),s=l.ssoCallbackUrl,c=l.afterSignUpUrl||"/",p="popup"===l.oauthFlow||"auto"===l.oauthFlow&&(0,I.t)(),{continueSignUp:h=!1,onAlternativePhoneCodeProviderClick:f,...g}=e;return(0,r.tZ)(K.L,{...g,idleAfterDelay:!p,oauthCallback:t=>{if(p){let i=window.open("about:blank","","width=600,height=800"),r=setInterval(()=>{(!i||i.closed)&&(clearInterval(r),a.setIdle())},500);return o.authenticateWithPopup({strategy:t,redirectUrl:s,redirectUrlComplete:c,popup:i,continueSignUp:h,unsafeMetadata:l.unsafeMetadata,legalAccepted:e.legalAccepted,oidcPrompt:l.oidcPrompt}).catch(e=>(0,b.S3)(e,[],a.setError))}return o.authenticateWithRedirect({continueSignUp:h,redirectUrl:s,redirectUrlComplete:c,strategy:t,unsafeMetadata:l.unsafeMetadata,legalAccepted:e.legalAccepted,oidcPrompt:l.oidcPrompt}).catch(e=>(0,b.S3)(e,[],a.setError))},web3Callback:r=>t.authenticateWithWeb3({customNavigate:i,redirectUrl:c,signUpContinueUrl:"continue",unsafeMetadata:l.unsafeMetadata,strategy:r,legalAccepted:e.legalAccepted}).catch(e=>(0,z.H)(e,a.setError)),alternativePhoneCodeCallback:e=>{f?.(e)}})});var L=i(6052);let q=(0,m.withCardStateProvider)(function(){let e=(0,m.useCardState)(),t=(0,n.cL)(),{navigate:i}=(0,u.useRouter)(),{displayConfig:l,userSettings:o}=(0,d.useEnvironment)(),{attributes:s,usernameSettings:y}=o,{t:S,locale:A}=(0,c.useLocalizations)(),{afterSignUpUrl:U,signInUrl:Z,unsafeMetadata:N,initialValues:k={},isCombinedFlow:R,navigateOnSetActive:I}=(0,d.useSignUpContext)(),z=(0,d.useCoreSignUp)(),K=!!a.useContext(d.SignInContext),q=!!(R&&K),T=o.signUp.progressive,[B,O]=a.useState(w(s,o.signUp.progressive)),x=(0,d.useSignUpContext)(),M={firstName:(0,_.Yp)("firstName",k.firstName||"",{type:"text",label:(0,c.localizationKeys)("formFieldLabel__firstName"),placeholder:(0,c.localizationKeys)("formFieldInputPlaceholder__firstName")}),lastName:(0,_.Yp)("lastName",k.lastName||"",{type:"text",label:(0,c.localizationKeys)("formFieldLabel__lastName"),placeholder:(0,c.localizationKeys)("formFieldInputPlaceholder__lastName")}),emailAddress:(0,_.Yp)("emailAddress",k.emailAddress||z.emailAddress||"",{type:"email",label:(0,c.localizationKeys)("formFieldLabel__emailAddress"),placeholder:(0,c.localizationKeys)("formFieldInputPlaceholder__emailAddress")}),username:(0,_.Yp)("username",k.username||"",{type:"text",label:(0,c.localizationKeys)("formFieldLabel__username"),placeholder:(0,c.localizationKeys)("formFieldInputPlaceholder__username"),transformer:e=>e.trim(),buildErrorMessage:e=>(0,v.f)(e,{t:S,locale:A,usernameSettings:y})}),phoneNumber:(0,_.Yp)("phoneNumber",k.phoneNumber||"",{type:"tel",label:(0,c.localizationKeys)("formFieldLabel__phoneNumber"),placeholder:(0,c.localizationKeys)("formFieldInputPlaceholder__phoneNumber")}),password:(0,_.Yp)("password","",{type:"password",label:(0,c.localizationKeys)("formFieldLabel__password"),placeholder:(0,c.localizationKeys)("formFieldInputPlaceholder__password"),validatePassword:!0}),legalAccepted:(0,_.Yp)("legalAccepted","",{type:"checkbox",label:"",defaultChecked:!1,isRequired:o.signUp.legal_consent_enabled||!1})},D=(0,a.useMemo)(()=>z.missingFields&&1===z.missingFields.length&&"legal_accepted"===z.missingFields[0]&&z.unverifiedFields&&0===z.unverifiedFields.length,[z.missingFields,z.unverifiedFields]);if((0,a.useEffect)(()=>{z.id||!0===t.__internal_setActiveInProgress||i(l.signUpUrl)},[]),!z.id)return(0,r.tZ)(f.W,{});let V=!!M.emailAddress.value,X=z.verifications?.externalAccount?.status=="verified",W=P({attributes:s,hasEmail:V,activeCommIdentifierType:B,signUp:z,isProgressiveSignUp:T,legalConsentRequired:o.signUp.legal_consent_enabled});!function(e,t){if(t){let i=!!t.emailAddress,r=t.verifications?.emailAddress?.status==="verified",n=t.verifications?.phoneNumber?.status==="verified",a=t.verifications?.externalAccount?.status==="verified",l=t.verifications?.web3Wallet?.status==="verified",o=null!==t.legalAcceptedAt;i&&r&&delete e.emailAddress,n&&delete e.phoneNumber,(a||l)&&delete e.password,t.firstName&&delete e.firstName,t.lastName&&delete e.lastName,t.username&&delete e.username,o&&delete e.legalAccepted,Object.entries(e).forEach(([t,i])=>{i&&!i.required&&delete e[t]})}}(W,z);let H=o.authenticatableSocialStrategies,Y=async r=>{r.preventDefault();let n=Object.entries(W).reduce((e,[t,i])=>[...e,...i&&M[t]?[M[t]]:[]],[]);N&&n.push({id:"unsafeMetadata",value:N});let a=!!n.find(e=>"emailAddress"===e.id)?.value,l=!!n.find(e=>"phoneNumber"===e.id)?.value;return z.missingFields.includes("email_address")&&z.missingFields.includes("phone_number")&&!a&&!l&&E(s,T)&&(n.push(M.emailAddress),n.push(M.phoneNumber)),e.setLoading(),e.setError(void 0),z.update((0,_.ni)(n)).then(e=>(0,L.completeSignUpFlow)({signUp:e,verifyEmailPath:"./verify-email-address",verifyPhonePath:"./verify-phone-number",handleComplete:()=>t.setActive({session:e.createdSessionId,navigate:async({session:e})=>{await I({session:e,redirectUrl:U})}}),navigate:i,oidcPrompt:x.oidcPrompt})).catch(t=>(0,b.S3)(t,n,e.setError)).finally(()=>e.setIdle())},j=E(s,T),$=!X&&H.length>0,G=D?(0,c.localizationKeys)("signUp.legalConsent.continue.title"):(0,c.localizationKeys)("signUp.continue.title"),J=D?(0,c.localizationKeys)("signUp.legalConsent.continue.subtitle"):(0,c.localizationKeys)("signUp.continue.subtitle");return(0,r.tZ)(c.Flow.Part,{part:"complete",children:(0,r.BX)(p.Z.Root,{children:[(0,r.BX)(p.Z.Content,{children:[(0,r.BX)(h.h.Root,{showLogo:!0,children:[(0,r.tZ)(h.h.Title,{localizationKey:G}),(0,r.tZ)(h.h.Subtitle,{localizationKey:J})]}),(0,r.tZ)(p.Z.Alert,{children:e.error}),(0,r.tZ)(c.Flex,{direction:"col",elementDescriptor:c.descriptors.main,gap:8,children:(0,r.BX)(g.G,{children:[$&&!D&&(0,r.tZ)(F,{enableOAuthProviders:$,enableWeb3Providers:!1,enableAlternativePhoneCodeProviders:!1,continueSignUp:!0}),(0,r.tZ)(C,{handleSubmit:Y,fields:W,formState:M,onlyLegalAcceptedMissing:D,canToggleEmailPhone:j,handleEmailPhoneToggle:e=>{E(s,T)&&O(e)}})]})})]}),(0,r.tZ)(p.Z.Footer,{children:q?null:(0,r.BX)(p.Z.Action,{elementId:"signUp",children:[(0,r.tZ)(p.Z.ActionText,{localizationKey:(0,c.localizationKeys)("signUp.continue.actionText")}),(0,r.tZ)(p.Z.ActionLink,{localizationKey:(0,c.localizationKeys)("signUp.continue.actionLink"),to:q?"../../":t.buildUrlWithAuth(Z)})]})})]})})});var T=i(9281),B=i(1989),O=i(6352);let x=(0,T.sN)((0,m.withCardStateProvider)(()=>{let e=(0,n.cL)(),t=(0,d.useSignUpContext)(),i=e.client.signUp,{data:a,isLoading:l}=(0,O.ib)(i?.__experimental_getEnterpriseConnections,{signUpId:i.id});return l||a?.length?(0,r.tZ)(c.Flow.Part,{part:"enterpriseConnections",children:a?.length?(0,r.tZ)(B.c,{title:(0,c.localizationKeys)("signUp.enterpriseConnections.title"),subtitle:(0,c.localizationKeys)("signUp.enterpriseConnections.subtitle"),onClick:e=>{let r=t.ssoCallbackUrl,n=t.afterSignUpUrl||"/";return i.authenticateWithRedirect({strategy:"enterprise_sso",redirectUrl:r,redirectUrlComplete:n,continueSignUp:!0,enterpriseConnectionId:e})},enterpriseConnections:a}):l?(0,r.tZ)(f.W,{}):null}):null})),M=(0,T.jT)((0,T.sN)(T.L));var D=i(6543),V=i(9325),X=i(6842),W=i(753),H=i(4029),Y=i(5518),j=i(3234),$=i(4174);let G=()=>{let e=(0,n.cL)(),t=(0,m.useCardState)(),{navigate:i}=(0,u.useRouter)(),{signInUrl:a,waitlistUrl:l}=(0,d.useSignUpContext)(),o=(0,j.H)(),{userSettings:s}=(0,d.useEnvironment)(),{mode:f}=s.signUp,g=async()=>{await i(e.buildUrlWithAuth(l))},b=f===W.ci.RESTRICTED?(0,c.localizationKeys)("signUp.restrictedAccess.subtitle"):(0,c.localizationKeys)("signUp.restrictedAccess.subtitleWaitlist");return(0,r.BX)(p.Z.Root,{children:[(0,r.BX)(p.Z.Content,{children:[(0,r.BX)(h.h.Root,{showLogo:!0,children:[(0,r.tZ)(c.Icon,{icon:$.gO,sx:e=>({margin:"auto",width:e.sizes.$10,height:e.sizes.$10})}),(0,r.tZ)(h.h.Title,{localizationKey:(0,c.localizationKeys)("signUp.restrictedAccess.title")}),(0,r.tZ)(h.h.Subtitle,{localizationKey:b})]}),(0,r.tZ)(p.Z.Alert,{children:t.error}),f===W.ci.RESTRICTED&&o&&(0,r.tZ)(c.Flex,{direction:"col",gap:4,children:(0,r.tZ)(c.Button,{localizationKey:(0,c.localizationKeys)("signUp.restrictedAccess.blockButton__emailSupport"),onClick:()=>{window.location.href=`mailto:${o}`}})}),f===W.ci.WAITLIST&&(0,r.tZ)(c.Flex,{direction:"col",gap:4,children:(0,r.tZ)(c.Button,{localizationKey:(0,c.localizationKeys)("signUp.restrictedAccess.blockButton__joinWaitlist"),onClick:g})})]}),(0,r.tZ)(p.Z.Footer,{children:(0,r.BX)(p.Z.Action,{elementId:"signUp",children:[(0,r.tZ)(p.Z.ActionText,{localizationKey:(0,c.localizationKeys)("signUp.restrictedAccess.actionText")}),(0,r.tZ)(p.Z.ActionLink,{localizationKey:(0,c.localizationKeys)("signUp.restrictedAccess.actionLink"),to:e.buildUrlWithAuth(a)})]})})]})},J=e=>{let{handleSubmit:t,fields:i,formState:n,onUseAnotherMethod:a,phoneCodeProvider:l}=e,{providerToDisplayData:o,strategyToDisplayData:s}=(0,O.vO)(),d=l.name,u=l.channel,f=(0,m.useCardState)();return(0,r.tZ)(p.Z.Root,{children:(0,r.BX)(p.Z.Content,{children:[(0,r.BX)(h.h.Root,{showLogo:!0,showDivider:!0,children:[(0,r.tZ)(c.Col,{center:!0,children:(0,r.tZ)(c.Image,{src:o[l.channel]?.iconUrl,alt:`${s[u].name} logo`,sx:e=>({width:e.sizes.$7,height:e.sizes.$7,maxWidth:"100%",marginBottom:e.sizes.$6})})}),(0,r.tZ)(h.h.Title,{localizationKey:(0,c.localizationKeys)("signUp.start.alternativePhoneCodeProvider.title",{provider:d})}),(0,r.tZ)(h.h.Subtitle,{localizationKey:(0,c.localizationKeys)("signUp.start.alternativePhoneCodeProvider.subtitle",{provider:d})})]}),(0,r.tZ)(p.Z.Alert,{children:f.error}),(0,r.tZ)(c.Flex,{direction:"col",elementDescriptor:c.descriptors.main,gap:6,children:(0,r.BX)(y.l.Root,{onSubmit:t,gap:8,children:[(0,r.tZ)(c.Col,{gap:6,children:(0,r.tZ)(y.l.ControlRow,{elementId:"phoneNumber",children:(0,r.tZ)(y.l.PhoneInput,{...n.phoneNumber.props,label:(0,c.localizationKeys)("signUp.start.alternativePhoneCodeProvider.label",{provider:d||""}),isRequired:!0,isOptional:!1,actionLabel:void 0,onActionClicked:void 0})})}),(0,r.BX)(c.Col,{center:!0,children:[(0,r.tZ)(A.S,{}),(0,r.BX)(c.Col,{gap:6,sx:{width:"100%"},children:[!!i.legalAccepted&&i.legalAccepted?.required&&(0,r.tZ)(y.l.ControlRow,{elementId:"legalAccepted",children:(0,r.tZ)(S.H,{...n.legalAccepted.props,isRequired:i.legalAccepted?.required})}),(0,r.tZ)(y.l.SubmitButton,{hasArrow:!0,localizationKey:(0,c.localizationKeys)("formButtonPrimary")})]})]}),(0,r.tZ)(c.Col,{center:!0,children:(0,r.tZ)(c.Button,{variant:"link",colorScheme:"neutral",onClick:a,localizationKey:(0,c.localizationKeys)("signUp.start.alternativePhoneCodeProvider.actionLink")})})]})})]})})},Q=(0,T.jT)((0,T.sN)((0,m.withCardStateProvider)(function(){let e=(0,m.useCardState)(),t=(0,n.cL)(),i=(0,O._m)(),l=(0,d.useCoreSignUp)(),{showOptionalFields:o}=(0,c.useAppearance)().parsedLayout,{userSettings:s,authConfig:y}=(0,d.useEnvironment)(),{navigate:S}=(0,u.useRouter)(),{attributes:U}=s,{setActive:Z}=(0,n.cL)(),N=(0,d.useSignUpContext)(),k=!!a.useContext(d.SignInContext),{afterSignUpUrl:R,signInUrl:I,unsafeMetadata:z,navigateOnSetActive:K}=N,q=!!(N.isCombinedFlow&&k),[T,B]=a.useState(()=>w(U,s.signUp.progressive,{phoneNumber:N.initialValues?.phoneNumber===null?void 0:N.initialValues?.phoneNumber,emailAddress:N.initialValues?.emailAddress===null?void 0:N.initialValues?.emailAddress,...q?{emailAddress:l.emailAddress,phoneNumber:l.phoneNumber}:{}})),{t:x,locale:M}=(0,c.useLocalizations)(),j=N.initialValues||{},[$,Q]=a.useState(null),[ee,et]=a.useState(!1),{userSettings:{passwordSettings:ei,usernameSettings:er}}=(0,d.useEnvironment)(),{mode:en}=s.signUp,ea={firstName:(0,_.Yp)("firstName",l.firstName||j.firstName||"",{type:"text",label:(0,c.localizationKeys)("formFieldLabel__firstName"),placeholder:(0,c.localizationKeys)("formFieldInputPlaceholder__firstName")}),lastName:(0,_.Yp)("lastName",l.lastName||j.lastName||"",{type:"text",label:(0,c.localizationKeys)("formFieldLabel__lastName"),placeholder:(0,c.localizationKeys)("formFieldInputPlaceholder__lastName")}),emailAddress:(0,_.Yp)("emailAddress",l.emailAddress||j.emailAddress||"",{type:"email",label:(0,c.localizationKeys)("formFieldLabel__emailAddress"),placeholder:(0,c.localizationKeys)("formFieldInputPlaceholder__emailAddress")}),username:(0,_.Yp)("username",l.username||j.username||"",{type:"text",label:(0,c.localizationKeys)("formFieldLabel__username"),placeholder:(0,c.localizationKeys)("formFieldInputPlaceholder__username"),transformer:e=>e.trim(),buildErrorMessage:e=>(0,v.f)(e,{t:x,locale:M,usernameSettings:er})}),phoneNumber:(0,_.Yp)("phoneNumber",l.phoneNumber||j.phoneNumber||"",{type:"tel",label:(0,c.localizationKeys)("formFieldLabel__phoneNumber"),placeholder:(0,c.localizationKeys)("formFieldInputPlaceholder__phoneNumber")}),legalAccepted:(0,_.Yp)("legalAccepted","",{type:"checkbox",label:"",defaultChecked:!1,isRequired:s.signUp.legal_consent_enabled||!1}),password:(0,_.Yp)("password","",{type:"password",label:(0,c.localizationKeys)("formFieldLabel__password"),placeholder:(0,c.localizationKeys)("formFieldInputPlaceholder__password"),validatePassword:!0,buildErrorMessage:e=>(0,X.GM)(e,{t:x,locale:M,passwordSettings:ei})}),ticket:(0,_.Yp)("ticket",(0,H.XV)("__clerk_ticket")||(0,H.XV)("__clerk_invitation_token")||"")},el=!!ea.ticket.value,eo=!!(l.id&&null!==l.status&&((0,H.XV)("__clerk_ticket")||(0,H.XV)("__clerk_invitation_token"))),es=!!ea.emailAddress.value,ed=s.signUp.progressive,ec=s.signUp.legal_consent_enabled,eu=N.oidcPrompt,ep=P({attributes:U,hasTicket:el||eo,hasEmail:es,activeCommIdentifierType:T,isProgressiveSignUp:ed,legalConsentRequired:ec});a.useLayoutEffect(()=>{ea.ticket.value&&(i.setLoading(),e.setLoading(),l.create({strategy:"ticket",ticket:ea.ticket.value}).then(e=>{ea.emailAddress.setValue(e.emailAddress||""),"missing_requirements"===e.status&&et(!0);let t=N.ssoCallbackUrl,i=N.afterSignUpUrl||"/";return(0,L.completeSignUpFlow)({signUp:e,redirectUrl:t,redirectUrlComplete:i,verifyEmailPath:"verify-email-address",verifyPhonePath:"verify-phone-number",handleComplete:()=>((0,H.xy)("__clerk_ticket"),(0,H.xy)("__clerk_invitation_token"),Z({session:e.createdSessionId,navigate:async({session:e})=>{await K({session:e,redirectUrl:R})}})),navigate:S,oidcPrompt:eu})}).catch(t=>{ea.ticket.setValue(""),(0,b.S3)(t,[],e.setError)}).finally(()=>{l.missingFields.some(e=>"saml"===e||"enterprise_sso"===e)||(i.setIdle(),e.setIdle())}))},[]),a.useEffect(()=>{!async function(){let t=l.verifications.externalAccount.error;if(t){switch(t.code){case W.O1.NOT_ALLOWED_TO_SIGN_UP:case W.O1.OAUTH_ACCESS_DENIED:case W.O1.NOT_ALLOWED_ACCESS:case W.O1.SAML_USER_ATTRIBUTE_MISSING:case W.O1.OAUTH_EMAIL_DOMAIN_RESERVED_BY_SAML:case W.O1.USER_LOCKED:case W.O1.ENTERPRISE_SSO_USER_ATTRIBUTE_MISSING:case W.O1.ENTERPRISE_SSO_EMAIL_ADDRESS_DOMAIN_MISMATCH:case W.O1.ENTERPRISE_SSO_HOSTED_DOMAIN_MISMATCH:case W.O1.SAML_EMAIL_ADDRESS_DOMAIN_MISMATCH:case W.O1.ORGANIZATION_MEMBERSHIP_QUOTA_EXCEEDED_FOR_SSO:case W.O1.CAPTCHA_INVALID:case W.O1.FRAUD_DEVICE_BLOCKED:case W.O1.FRAUD_ACTION_BLOCKED:case W.O1.SIGNUP_RATE_LIMIT_EXCEEDED:case W.O1.USER_BANNED:e.setError(t);break;default:e.setError("Unable to complete action at this time. If the problem persists please contact support.")}await l.create({})}}()},[]);let em=async t=>{t.preventDefault();let i=Object.entries(ep).reduce((e,[t,i])=>(e.push(...i&&ea[t]?[ea[t]]:[]),e),[]);if(z&&i.push({id:"unsafeMetadata",value:z}),ep.ticket||eo){let e=()=>{};if(i.push({id:"strategy",value:"ticket",clearFeedback:e,setValue:e,onChange:e,setError:e}),!ea.ticket.value&&eo){let t=(0,H.XV)("__clerk_ticket")||(0,H.XV)("__clerk_invitation_token");t&&i.push({id:"ticket",value:t,clearFeedback:e,setValue:e,onChange:e,setError:e})}}let r=$?.channel||(0,Y.Vs)(i,y.preferredChannels,"phoneNumber");if(r){let e=()=>{};i.push({id:"strategy",value:"phone_code",clearFeedback:e,setValue:e,onChange:e,setError:e}),i.push({id:"channel",value:r,clearFeedback:e,setValue:e,onChange:e,setError:e})}let n=!!i.find(e=>"emailAddress"===e.id)?.value,a=!!i.find(e=>"phoneNumber"===e.id)?.value;!n&&!a&&E(U,ed)&&(i.push(ea.emailAddress),i.push(ea.phoneNumber)),e.setLoading(),e.setError(void 0);let o=N.ssoCallbackUrl,s=N.afterSignUpUrl||"/";return(ep.ticket||eo?l.upsert((0,_.ni)(i)):l.create((0,_.ni)(i))).then(e=>(0,L.completeSignUpFlow)({signUp:e,verifyEmailPath:"verify-email-address",verifyPhonePath:"verify-phone-number",handleComplete:()=>Z({session:e.createdSessionId,navigate:async({session:e})=>{await K({session:e,redirectUrl:R})}}),navigate:S,redirectUrl:o,redirectUrlComplete:s,oidcPrompt:eu})).catch(t=>(0,V.kD)(t)&&t.errors?.[0]?.code==="enterprise_connection_id_is_required_with_multiple_connections"?S("./enterprise-connections"):(0,b.S3)(t,i,e.setError)).finally(()=>e.setIdle())};if(i.isLoading)return(0,r.tZ)(f.W,{});let eh=E(U,ed),ef=Object.entries(ep).filter(([e,t])=>o||t?.required),eg=function(e){let{authenticatableSocialStrategies:t,web3FirstFactors:i}=e;return e.hasValidAuthFactor||!t.length&&!i.length}(s)&&ef.length>0,eb=(!(el||eo)||ee)&&s.authenticatableSocialStrategies.length>0,e_=!(el||eo)&&s.web3FirstFactors.length>0,ev=!(el||eo)&&s.alternativePhoneCodeChannels.length>0;return en===W.ci.PUBLIC||el||eo?(0,r.tZ)(c.Flow.Part,{part:"start",children:$?(0,r.tZ)(J,{handleSubmit:em,fields:ep,formState:ea,onUseAnotherMethod:()=>{Q(null)},phoneCodeProvider:$}):(0,r.BX)(p.Z.Root,{children:[(0,r.BX)(p.Z.Content,{children:[(0,r.BX)(h.h.Root,{showLogo:!0,children:[(0,r.tZ)(h.h.Title,{localizationKey:q?(0,c.localizationKeys)("signUp.start.titleCombined"):(0,c.localizationKeys)("signUp.start.title")}),(0,r.tZ)(h.h.Subtitle,{localizationKey:q?(0,c.localizationKeys)("signUp.start.subtitleCombined"):(0,c.localizationKeys)("signUp.start.subtitle")})]}),(0,r.tZ)(p.Z.Alert,{children:e.error}),(0,r.BX)(c.Flex,{direction:"col",elementDescriptor:c.descriptors.main,gap:6,children:[(0,r.BX)(g.G,{children:[(eb||e_||ev)&&(0,r.tZ)(F,{enableOAuthProviders:eb,enableWeb3Providers:e_,enableAlternativePhoneCodeProviders:ev,onAlternativePhoneCodeProviderClick:e=>{Q((0,D.H)(e)||null)},continueSignUp:ee,legalAccepted:!!ea.legalAccepted.checked||void 0}),eg&&(0,r.tZ)(C,{handleSubmit:em,fields:ep,formState:ea,canToggleEmailPhone:eh,handleEmailPhoneToggle:e=>{E(U,ed)&&B(e)}})]}),!eg&&(0,r.tZ)(A.S,{})]})]}),(0,r.tZ)(p.Z.Footer,{children:(0,r.BX)(p.Z.Action,{elementId:"signUp",children:[(0,r.tZ)(p.Z.ActionText,{localizationKey:(0,c.localizationKeys)("signUp.start.actionText")}),(0,r.tZ)(p.Z.ActionLink,{localizationKey:(0,c.localizationKeys)("signUp.start.actionLink"),to:q?"../":t.buildUrlWithAuth(I)})]})})]})}):(0,r.tZ)(G,{})})));var ee=i(3465);let et=e=>{let{afterSignUpUrl:t,navigateOnSetActive:i,isCombinedFlow:l}=(0,d.useSignUpContext)(),{setActive:o}=(0,n.cL)(),{navigate:s}=(0,u.useRouter)(),c=!!(a.useContext(d.SignInContext)&&l);return(0,r.tZ)(ee.U,{cardTitle:e.cardTitle,cardSubtitle:e.cardSubtitle,resendButton:e.resendButton,onCodeEntryFinishedAction:(r,n,a)=>{e.attempt(r).then(async e=>(await n(),(0,L.completeSignUpFlow)({signUp:e,verifyEmailPath:"../verify-email-address",verifyPhonePath:"../verify-phone-number",continuePath:"../continue",handleComplete:()=>o({session:e.createdSessionId,navigate:async({session:e})=>{await i({session:e,redirectUrl:t})}}),navigate:s}))).catch(e=>a(e))},onResendCodeClicked:e.prepare,safeIdentifier:e.safeIdentifier,onIdentityPreviewEditClicked:()=>s(c?"../../":"../",{searchParams:(0,H.z3)()}),alternativeMethodsLabel:e.alternativeMethodsLabel,onShowAlternativeMethodsClicked:e.onShowAlternativeMethodsClicked,showAlternativeMethods:e.showAlternativeMethods})},ei=()=>{let e=(0,d.useCoreSignUp)(),t=(0,m.useCardState)(),i=e.verifications.emailAddress.status,n=!e.status||"verified"===i;return(0,O.ib)(n?void 0:()=>e.prepareEmailAddressVerification({strategy:"email_code"}),{name:"prepare",strategy:"email_code",number:e.emailAddress},{staleTime:100,onError:e=>(0,b.S3)(e,[],t.setError)}),(0,r.tZ)(c.Flow.Part,{part:"emailCode",children:(0,r.tZ)(et,{cardTitle:(0,c.localizationKeys)("signUp.emailCode.title"),cardSubtitle:(0,c.localizationKeys)("signUp.emailCode.subtitle"),inputLabel:(0,c.localizationKeys)("signUp.emailCode.formSubtitle"),resendButton:(0,c.localizationKeys)("signUp.emailCode.resendButton"),prepare:()=>{if(!n)return e.prepareEmailAddressVerification({strategy:"email_code"}).catch(e=>(0,b.S3)(e,[],t.setError))},attempt:t=>e.attemptEmailAddressVerification({code:t}),safeIdentifier:e.emailAddress})})};var er=i(5495),en=i(4814);let ea=()=>{let{t:e}=(0,c.useLocalizations)(),t=(0,d.useCoreSignUp)(),i=(0,d.useSignUpContext)(),{afterSignUpUrl:l,navigateOnSetActive:o}=i,s=(0,m.useCardState)(),{navigate:p}=(0,u.useRouter)(),{setActive:h}=(0,n.cL)(),[f,g]=a.useState(!1),{startEmailLinkFlow:_,cancelEmailLinkFlow:v}=(0,en.E)(t);a.useEffect(()=>{y()},[]);let y=()=>_({redirectUrl:i.emailLinkRedirectUrl}).then(e=>S(e)).catch(e=>{(0,b.S3)(e,[],s.setError)}),S=async t=>{let i=t.verifications.emailAddress;"expired"===i.status?s.setError(e((0,c.localizationKeys)("formFieldError__verificationLinkExpired"))):i.verifiedFromTheSameClient()?g(!0):await (0,L.completeSignUpFlow)({signUp:t,continuePath:"../continue",verifyEmailPath:"../verify-email-address",verifyPhonePath:"../verify-phone-number",handleComplete:()=>h({session:t.createdSessionId,navigate:async({session:e})=>{await o({session:e,redirectUrl:l})}}),navigate:p})};return f?(0,r.tZ)(T.Ej,{title:(0,c.localizationKeys)("signUp.emailLink.verifiedSwitchTab.title"),subtitle:(0,c.localizationKeys)("signUp.emailLink.verifiedSwitchTab.subtitleNewTab"),status:"verified_switch_tab"}):(0,r.tZ)(c.Flow.Part,{part:"emailLink",children:(0,r.tZ)(er.J,{cardTitle:(0,c.localizationKeys)("signUp.emailLink.title"),cardSubtitle:(0,c.localizationKeys)("signUp.emailLink.subtitle"),formTitle:(0,c.localizationKeys)("signUp.emailLink.formTitle"),formSubtitle:(0,c.localizationKeys)("signUp.emailLink.formSubtitle"),resendButton:(0,c.localizationKeys)("signUp.emailLink.resendButton"),onResendCodeClicked:()=>{v(),y()},safeIdentifier:t.emailAddress})})},el=(0,m.withCardStateProvider)(()=>{let{userSettings:e}=(0,d.useEnvironment)(),{attributes:t}=e;return t.email_address?.verifications?.includes("email_link")?(0,r.tZ)(ea,{}):(0,r.tZ)(ei,{})}),eo=(0,m.withCardStateProvider)(()=>{let e=(0,d.useCoreSignUp)(),t=(0,m.useCardState)(),i=e.verifications.phoneNumber.channel,n=e.verifications.phoneNumber.status,a=!e.status||"verified"===n,l=!!i&&"sms"!==i,o=l?i:void 0;(0,O.ib)(a||l?void 0:()=>e.preparePhoneNumberVerification({strategy:"phone_code",channel:void 0}),{name:"signUp.preparePhoneNumberVerification",strategy:"phone_code",number:e.phoneNumber},{staleTime:100,onError:e=>(0,b.S3)(e,[],t.setError)});let s=(0,c.localizationKeys)("signUp.phoneCode.title"),u=(0,c.localizationKeys)("signUp.phoneCode.subtitle"),p=(0,c.localizationKeys)("signUp.phoneCode.resendButton");if(l){let e=(0,D.H)(i)?.name;s=(0,c.localizationKeys)("signUp.alternativePhoneCodeProvider.title",{provider:e||""}),u=(0,c.localizationKeys)("signUp.alternativePhoneCodeProvider.subtitle",{provider:e||""}),p=(0,c.localizationKeys)("signUp.alternativePhoneCodeProvider.resendButton")}return t.isLoading?(0,r.tZ)(f.W,{}):(0,r.tZ)(c.Flow.Part,{part:"phoneCode",children:(0,r.tZ)(et,{cardTitle:s,cardSubtitle:u,resendButton:p,prepare:()=>{if(!a)return e.preparePhoneNumberVerification({strategy:"phone_code",channel:o}).catch(e=>(0,b.S3)(e,[],t.setError))},attempt:t=>e.attemptPhoneNumberVerification({code:t}),safeIdentifier:e.phoneNumber,alternativeMethodsLabel:l?(0,c.localizationKeys)("footerActionLink__alternativePhoneCodeProvider"):void 0,onShowAlternativeMethodsClicked:l?()=>{t.setLoading(),t.setError(void 0),e.preparePhoneNumberVerification({strategy:"phone_code",channel:void 0}).catch(e=>(0,b.S3)(e,[],t.setError)).finally(()=>t.setIdle())}:void 0,showAlternativeMethods:!!l||void 0})})}),es=()=>(0,r.tZ)(eo,{});function ed(){let e=(0,n.cL)();return a.useEffect(()=>{e.redirectToSignUp()},[]),null}function ec(){(0,l.z)();let e=(0,d.useSignUpContext)();return(0,r.tZ)(c.Flow.Root,{flow:"signUp",children:(0,r.BX)(u.Switch,{children:[(0,r.tZ)(u.Route,{path:"verify-email-address",canActivate:e=>!!e.client.signUp.emailAddress,children:(0,r.tZ)(el,{})}),(0,r.tZ)(u.Route,{path:"verify-phone-number",canActivate:e=>!!e.client.signUp.phoneNumber,children:(0,r.tZ)(es,{})}),(0,r.tZ)(u.Route,{path:"sso-callback",children:(0,r.tZ)(M,{signUpUrl:e.signUpUrl,signInUrl:e.signInUrl,signUpForceRedirectUrl:e.afterSignUpUrl,signInForceRedirectUrl:e.afterSignInUrl,secondFactorUrl:e.secondFactorUrl,continueSignUpUrl:"../continue",verifyEmailAddressUrl:"../verify-email-address",verifyPhoneNumberUrl:"../verify-phone-number"})}),(0,r.tZ)(u.Route,{path:"verify",children:(0,r.tZ)(s.$,{redirectUrlComplete:e.afterSignUpUrl,verifyEmailPath:"../verify-email-address",verifyPhonePath:"../verify-phone-number"})}),(0,r.BX)(u.Route,{path:"continue",children:[(0,r.tZ)(u.Route,{path:"verify-email-address",canActivate:e=>!!e.client.signUp.emailAddress,children:(0,r.tZ)(el,{})}),(0,r.tZ)(u.Route,{path:"verify-phone-number",canActivate:e=>!!e.client.signUp.phoneNumber,children:(0,r.tZ)(es,{})}),(0,r.tZ)(u.Route,{index:!0,children:(0,r.tZ)(q,{})})]}),(0,r.tZ)(u.Route,{path:"tasks",children:(0,r.tZ)(o.x7,{redirectUrlComplete:e.afterSignUpUrl})}),(0,r.tZ)(u.Route,{path:"enterprise-connections",children:(0,r.tZ)(x,{})}),(0,r.tZ)(u.Route,{index:!0,children:(0,r.tZ)(Q,{})}),(0,r.tZ)(u.Route,{children:(0,r.tZ)(ed,{})})]})})}ec.displayName="SignUp";let eu=(0,d.withCoreSessionSwitchGuard)(ec),ep=e=>{let t={signInUrl:`/${u.VIRTUAL_ROUTER_BASE_PATH}/sign-in`,waitlistUrl:`/${u.VIRTUAL_ROUTER_BASE_PATH}/waitlist`,...e};return(0,r.tZ)(u.Route,{path:"sign-up",children:(0,r.tZ)(d.SignUpContext.Provider,{value:{componentName:"SignUp",...t,routing:"virtual",mode:"modal"},children:(0,r.tZ)("div",{children:(0,r.tZ)(eu,{...t,routing:"virtual"})})})})}},6052:function(e,t,i){i.r(t),i.d(t,{completeSignUpFlow:()=>r.v});var r=i(5756)}}]);