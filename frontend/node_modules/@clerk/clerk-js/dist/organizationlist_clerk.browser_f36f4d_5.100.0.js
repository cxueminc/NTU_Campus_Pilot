"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["158"],{1816:function(e,t,i){i.d(t,{$:()=>_});var a=i(3312),n=i(3799),r=i(9144),o=i(1576),l=i(2672),s=i(431),c=i(9460),d=i(8487),u=i(2654),g=i(3412),h=i(7263),p=i(7259),z=i(8870),m=i(6788),Z=i(9281),b=i(4204),C=i(4174),S=i(7703),$=i(8493),v=i(5727),x=i(8181),f=i(7484);let _=(0,l.withCardStateProvider)(e=>{let t=(0,l.useCardState)(),i=(0,Z.a2)({onNextStep:()=>t.setError(void 0)}),_=r.useRef(null),{createOrganization:L,isLoaded:w,setActive:y,userMemberships:P}=(0,n.eW)({userMemberships:f.AO.userMemberships}),{organization:k}=(0,n.o8)(),{organizationSettings:A}=(0,o.useEnvironment)(),[O,B]=r.useState(),D=(0,m.Yp)("name","",{type:"text",label:(0,S.u1)("formFieldLabel__organizationName"),placeholder:(0,S.u1)("formFieldInputPlaceholder__organizationName")}),I=(0,m.Yp)("slug","",{type:"text",label:(0,S.u1)("formFieldLabel__organizationSlug"),placeholder:(0,S.u1)("formFieldInputPlaceholder__organizationSlug")}),T=!!D.value,K=!A.slug.disabled&&!e.hideSlug,R=async a=>{if((a.preventDefault(),T)&&w)try{let t={name:D.value};K&&(t.slug=I.value);let a=await L(t);if(O&&await a.setLogo({file:O}),_.current=a,await y({organization:a}),P.revalidate?.(),e.skipInvitationScreen??1===a.maxAllowedMemberships)return F();i.nextStep()}catch(e){(0,z.S3)(e,[D,I],t.setError)}},F=()=>{e.navigateAfterCreateOrganization?.(_.current),e.onComplete?.()},E=e=>{I.setValue(e)},X="organizationList"===e.flow?"subtitle":void 0;return(0,a.BX)(Z.en,{...i.props,children:[(0,a.tZ)(d.Y,{headerTitle:e?.startPage?.headerTitle,headerSubtitle:e?.startPage?.headerSubtitle,headerTitleTextVariant:"h2",headerSubtitleTextVariant:X,sx:e=>({minHeight:e.sizes.$60,gap:e.space.$6,textAlign:"left"}),children:(0,a.BX)(s.l.Root,{onSubmit:R,sx:e=>({gap:e.space.$6}),children:[(0,a.tZ)(b.Col,{children:(0,a.tZ)(x.D,{organization:{name:D.value},onAvatarChange:async e=>await B(e),onAvatarRemove:O?()=>(t.setIdle(),B(null)):null,avatarPreviewPlaceholder:(0,a.tZ)(g.h,{variant:"ghost","aria-label":"Upload organization logo",icon:(0,a.tZ)(b.Icon,{size:"md",icon:C.gq,sx:e=>({color:e.colors.$colorMutedForeground,transitionDuration:e.transitionDuration.$controls})}),sx:e=>({width:e.sizes.$16,height:e.sizes.$16,borderRadius:e.radii.$md,borderWidth:e.borderWidths.$normal,borderStyle:e.borderStyles.$dashed,borderColor:e.colors.$borderAlpha200,backgroundColor:e.colors.$neutralAlpha50,":hover":{backgroundColor:e.colors.$neutralAlpha50,svg:{transform:"scale(1.2)"}}})})})}),(0,a.tZ)(s.l.ControlRow,{elementId:D.id,children:(0,a.tZ)(s.l.PlainInput,{...D.props,onChange:e=>{D.setValue(e.target.value),E((0,p.q)(e.target.value))},isRequired:!0,autoFocus:!0,ignorePasswordManager:!0})}),K&&(0,a.tZ)(s.l.ControlRow,{elementId:I.id,children:(0,a.tZ)(s.l.PlainInput,{...I.props,onChange:e=>{E(e.target.value)},isRequired:!0,pattern:"^(?=.*[a-z0-9])[a-z0-9\\-]+$",ignorePasswordManager:!0})}),(0,a.BX)(c.K,{sx:e=>({marginTop:e.space.$none}),children:[(0,a.tZ)(s.l.SubmitButton,{block:!1,isDisabled:!T,localizationKey:(0,S.u1)("createOrganization.formButtonSubmit")}),e.onCancel&&(0,a.tZ)(s.l.ResetButton,{localizationKey:(0,S.u1)("userProfile.formButtonReset"),block:!1,onClick:e.onCancel})]})]})}),(0,a.tZ)(d.Y,{headerTitle:(0,S.u1)("organizationProfile.invitePage.title"),headerTitleTextVariant:"h2",headerSubtitleTextVariant:X,sx:e=>({minHeight:e.sizes.$60,textAlign:"left"}),children:k&&(0,a.tZ)($.l,{resetButtonLabel:(0,S.u1)("createOrganization.invitePage.formButtonReset"),onSuccess:i.nextStep,onReset:F})}),(0,a.BX)(b.Col,{children:[(0,a.tZ)(u.h.Root,{children:(0,a.tZ)(u.h.Title,{localizationKey:(0,S.u1)("organizationProfile.invitePage.title"),sx:{textAlign:"left"}})}),(0,a.tZ)(h.I,{contents:(0,a.tZ)(v.a,{}),sx:e=>({minHeight:e.sizes.$60}),onFinish:F})]})]})})},683:function(e,t,i){i.r(t),i.d(t,{OrganizationList:()=>E});var a=i(3312),n=i(1576),r=i(4204),o=i(4676),l=i(3799),s=i(9144),c=i(237),d=i(2305),u=i(2418),g=i(2672),h=i(2654),p=i(6028),z=i(4174),m=i(1816);let Z=e=>(0,a.tZ)(c.o2,{elementDescriptor:r.descriptors.organizationListPreviewItems,...e}),b=e=>(0,a.tZ)(c.ij,{elementId:"organizationList",elementDescriptor:r.descriptors.organizationListPreviewItem,...e}),C=e=>(0,a.tZ)(c.De,{elementDescriptor:r.descriptors.organizationListPreviewItemActionButton,...e}),S=e=>(0,a.tZ)(c.Td,{elementDescriptor:r.descriptors.organizationListPreviewButton,...e});var $=i(8870),v=i(7484),x=i(9325),f=i(5973),_=i(2915);let L=e=>{let{user:t}=(0,l.aF)(),i=(0,g.useCardState)(),{navigateAfterSelectOrganization:o}=(0,n.useOrganizationListContext)(),{t:s}=(0,r.useLocalizations)(),{isLoaded:d,setActive:u}=(0,l.eW)();return d?(0,a.tZ)(S,{onClick:()=>{let a;return a=e.organization,i.runAsync(async()=>{try{await u({organization:a}),await o(a)}catch(e){if(!(0,x.kD)(e))return void(0,$.S3)(e,[],i.setError);switch(e.errors?.[0]?.code){case"organization_not_found_or_unauthorized":case"not_a_member_in_organization":t?.createOrganizationEnabled?i.setError(s((0,r.localizationKeys)("unstable__errors.organization_not_found_or_unauthorized"))):i.setError(s((0,r.localizationKeys)("unstable__errors.organization_not_found_or_unauthorized_with_create_organization_disabled")));break;default:(0,$.S3)(e,[],i.setError)}}})},children:(0,a.tZ)(f.Z,{elementId:"organizationList",mainIdentifierSx:c.fq,organization:e.organization})}):null},w=(0,g.withCardStateProvider)(()=>{let e=(0,g.useCardState)(),{hidePersonal:t,navigateAfterSelectPersonal:i}=(0,n.useOrganizationListContext)(),{isLoaded:o,setActive:s}=(0,l.eW)(),{user:d}=(0,l.aF)();if(!d)return null;let{username:u,primaryEmailAddress:h,primaryPhoneNumber:p,...z}=d;return t?null:(0,a.tZ)(S,{onClick:()=>{if(o)return e.runAsync(async()=>{await s({organization:null}),await i(d)})},children:(0,a.tZ)(_.g,{user:z,mainIdentifierSx:c.fq,title:(0,r.localizationKeys)("organizationSwitcher.personalWorkspace")})})}),y={infinite:!0},P={infinite:!0},k={infinite:!0,status:["pending","accepted"]},A=e=>{let t=(0,g.useCardState)();return(0,a.tZ)(C,{isLoading:t.isLoading,onClick:e.onAccept,localizationKey:(0,r.localizationKeys)("organizationList.action__invitationAccept")})},O=(0,g.withCardStateProvider)(e=>{let t=(0,g.useCardState)(),{getOrganization:i}=(0,l.cL)(),[n,r]=(0,s.useState)(null),{userInvitations:o}=(0,l.eW)({userInvitations:P,userMemberships:y});return n?(0,a.tZ)(L,{organization:n}):(0,a.tZ)(b,{organizationData:e.publicOrganizationData,children:(0,a.tZ)(A,{onAccept:()=>t.runAsync(async()=>[await e.accept(),await i(e.publicOrganizationData.id)]).then(([e,t])=>{o?.setData?.(t=>(0,v.Sz)(e,t,"negative")),r(t)}).catch(e=>(0,$.S3)(e,[],t.setError))})})}),B=e=>{let t=(0,g.useCardState)(),{userSuggestions:i}=(0,l.eW)({userSuggestions:k});return"accepted"===e.status?(0,a.tZ)(r.Text,{colorScheme:"secondary",localizationKey:(0,r.localizationKeys)("organizationList.suggestionsAcceptedLabel")}):(0,a.tZ)(C,{isLoading:t.isLoading,onClick:()=>t.runAsync(e.accept).then(e=>i?.setData?.(t=>(0,v.Sz)(e,t))).catch(e=>(0,$.S3)(e,[],t.setError)),localizationKey:(0,r.localizationKeys)("organizationList.action__suggestionsAccept")})},D=(0,g.withCardStateProvider)(e=>(0,a.tZ)(b,{organizationData:e.publicOrganizationData,children:(0,a.tZ)(B,{...e})})),I=({onCreateOrganizationClick:e})=>{let{user:t}=(0,l.aF)();return t?.createOrganizationEnabled?(0,a.tZ)(d.aU,{elementDescriptor:r.descriptors.organizationListCreateOrganizationActionButton,icon:z.mm,label:(0,r.localizationKeys)("organizationList.action__createOrganization"),onClick:e,sx:e=>({borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$borderAlpha100,padding:`${e.space.$5} ${e.space.$5}`}),iconSx:e=>({width:e.sizes.$9,height:e.sizes.$6})}):null},T=(0,g.withCardStateProvider)(()=>{let{userMemberships:e,userSuggestions:t,userInvitations:i}=(0,p.H)(),o=e?.isLoading||i?.isLoading||t?.isLoading,l=!!(e?.count||i?.count||t?.count),{hidePersonal:s}=(0,n.useOrganizationListContext)();return(0,a.BX)(u.Z.Root,{children:[(0,a.BX)(u.Z.Content,{sx:e=>({padding:`${e.space.$8} ${e.space.$none} ${e.space.$none}`}),children:[o&&(0,a.tZ)(r.Flex,{direction:"row",align:"center",justify:"center",sx:e=>({height:"100%",minHeight:e.sizes.$60}),children:(0,a.tZ)(r.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:r.descriptors.spinner})}),!o&&(0,a.tZ)(K,{showListInitially:!(s&&!l)})]}),(0,a.tZ)(u.Z.Footer,{})]})}),K=({showListInitially:e})=>{let t=(0,g.useCardState)(),{navigateAfterCreateOrganization:i,skipInvitationScreen:o,hideSlug:l}=(0,n.useOrganizationListContext)(),[c,d]=(0,s.useState)(!e);return(0,a.BX)(a.HY,{children:[!c&&(0,a.tZ)(R,{onCreateOrganizationClick:()=>d(!0)}),c&&(0,a.BX)(a.HY,{children:[(0,a.tZ)(u.Z.Alert,{sx:e=>({margin:`${e.space.$none} ${e.space.$5}`}),children:t.error}),(0,a.tZ)(r.Box,{sx:e=>({padding:`${e.space.$none} ${e.space.$5} ${e.space.$5}`}),children:(0,a.tZ)(m.$,{flow:"organizationList",startPage:{headerTitle:(0,r.localizationKeys)("organizationList.createOrganization")},skipInvitationScreen:o,navigateAfterCreateOrganization:e=>i(e).then(()=>d(!1)),onCancel:e&&c?()=>d(!1):void 0,hideSlug:l})})]})]})},R=e=>{let t=(0,g.useCardState)(),i=(0,n.useEnvironment)(),{ref:o,userMemberships:l,userSuggestions:s,userInvitations:z}=(0,p.H)(),{hidePersonal:m}=(0,n.useOrganizationListContext)(),b=l?.isLoading||z?.isLoading||s?.isLoading,C=l?.hasNextPage||z?.hasNextPage||s?.hasNextPage,S=z.data?.filter(e=>!!e),$=s.data?.filter(e=>!!e);return(0,a.BX)(a.HY,{children:[(0,a.BX)(h.h.Root,{sx:e=>({padding:`${e.space.$none} ${e.space.$8}`}),children:[(0,a.tZ)(h.h.Title,{localizationKey:(0,r.localizationKeys)(m?"organizationList.titleWithoutPersonal":"organizationList.title")}),(0,a.tZ)(h.h.Subtitle,{localizationKey:(0,r.localizationKeys)("organizationList.subtitle",{applicationName:i.displayConfig.applicationName})})]}),(0,a.tZ)(u.Z.Alert,{sx:e=>({margin:`${e.space.$none} ${e.space.$5}`}),children:t.error}),(0,a.tZ)(r.Col,{elementDescriptor:r.descriptors.main,children:(0,a.tZ)(Z,{children:(0,a.BX)(d.eX,{role:"menu",children:[(0,a.tZ)(w,{}),(l.count||0)>0&&l.data?.map(e=>(0,a.tZ)(L,{...e},e.id)),!l.hasNextPage&&S?.map(e=>(0,a.tZ)(O,{...e},e.id)),!l.hasNextPage&&!z.hasNextPage&&$?.map(e=>(0,a.tZ)(D,{...e},e.id)),(C||b)&&(0,a.tZ)(c.pr,{ref:o}),(0,a.tZ)(I,{onCreateOrganizationClick:()=>{t.setError(void 0),e.onCreateOrganizationClick()}})]})})})]})},F=(0,n.withCoreUserGuard)(T),E=()=>(0,a.tZ)(r.Flow.Root,{flow:"organizationList",children:(0,a.tZ)(r.Flow.Part,{children:(0,a.tZ)(o.Switch,{children:(0,a.tZ)(o.Route,{children:(0,a.tZ)(F,{})})})})})}}]);