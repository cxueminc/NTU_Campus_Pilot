"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["158"],{91816:function(t,e,i){i.d(e,{$:()=>L}),i(65223);var a=i(73312),n=i(83799),o=i(69144),r=i(11576),l=i(2672),s=i(70431),c=i(19460),d=i(68487),u=i(92654),g=i(53412),h=i(67263),p=i(7259),z=i(88870),v=i(36788),m=i(79281),Z=i(64204),b=i(96519),C=i(17703),S=i(88493),x=i(45727),f=i(8181),_=i(57484);let L=(0,l.withCardStateProvider)(t=>{var e,i;let L=(0,l.useCardState)(),w=(0,m.a2)({onNextStep:()=>L.setError(void 0)}),y=o.useRef(null),{createOrganization:$,isLoaded:P,setActive:k,userMemberships:A}=(0,n.eW)({userMemberships:_.AO.userMemberships}),{organization:O}=(0,n.o8)(),{organizationSettings:B}=(0,r.useEnvironment)(),[D,I]=o.useState(),T=(0,v.Yp)("name","",{type:"text",label:(0,C.u1)("formFieldLabel__organizationName"),placeholder:(0,C.u1)("formFieldInputPlaceholder__organizationName")}),K=(0,v.Yp)("slug","",{type:"text",label:(0,C.u1)("formFieldLabel__organizationSlug"),placeholder:(0,C.u1)("formFieldInputPlaceholder__organizationSlug")}),R=!!T.value,F=!B.slug.disabled&&!t.hideSlug,E=async e=>{if((e.preventDefault(),R)&&P)try{var i,a;let e={name:T.value};F&&(e.slug=K.value);let n=await $(e);if(D&&await n.setLogo({file:D}),y.current=n,await k({organization:n}),null==(i=A.revalidate)||i.call(A),null!=(a=t.skipInvitationScreen)?a:1===n.maxAllowedMemberships)return X();w.nextStep()}catch(t){(0,z.S3)(t,[T,K],L.setError)}},X=()=>{var e,i;null==(e=t.navigateAfterCreateOrganization)||e.call(t,y.current),null==(i=t.onComplete)||i.call(t)},N=t=>{K.setValue(t)},W="organizationList"===t.flow?"subtitle":void 0;return(0,a.BX)(m.en,{...w.props,children:[(0,a.tZ)(d.Y,{headerTitle:null==t||null==(e=t.startPage)?void 0:e.headerTitle,headerSubtitle:null==t||null==(i=t.startPage)?void 0:i.headerSubtitle,headerTitleTextVariant:"h2",headerSubtitleTextVariant:W,sx:t=>({minHeight:t.sizes.$60,gap:t.space.$6,textAlign:"left"}),children:(0,a.BX)(s.l.Root,{onSubmit:E,sx:t=>({gap:t.space.$6}),children:[(0,a.tZ)(Z.Col,{children:(0,a.tZ)(f.D,{organization:{name:T.value},onAvatarChange:async t=>await I(t),onAvatarRemove:D?()=>(L.setIdle(),I(null)):null,avatarPreviewPlaceholder:(0,a.tZ)(g.h,{variant:"ghost","aria-label":"Upload organization logo",icon:(0,a.tZ)(Z.Icon,{size:"md",icon:b.gq,sx:t=>({color:t.colors.$colorMutedForeground,transitionDuration:t.transitionDuration.$controls})}),sx:t=>({width:t.sizes.$16,height:t.sizes.$16,borderRadius:t.radii.$md,borderWidth:t.borderWidths.$normal,borderStyle:t.borderStyles.$dashed,borderColor:t.colors.$borderAlpha200,backgroundColor:t.colors.$neutralAlpha50,":hover":{backgroundColor:t.colors.$neutralAlpha50,svg:{transform:"scale(1.2)"}}})})})}),(0,a.tZ)(s.l.ControlRow,{elementId:T.id,children:(0,a.tZ)(s.l.PlainInput,{...T.props,onChange:t=>{T.setValue(t.target.value),N((0,p.q)(t.target.value))},isRequired:!0,autoFocus:!0,ignorePasswordManager:!0})}),F&&(0,a.tZ)(s.l.ControlRow,{elementId:K.id,children:(0,a.tZ)(s.l.PlainInput,{...K.props,onChange:t=>{N(t.target.value)},isRequired:!0,pattern:"^(?=.*[a-z0-9])[a-z0-9\\-]+$",ignorePasswordManager:!0})}),(0,a.BX)(c.K,{sx:t=>({marginTop:t.space.$none}),children:[(0,a.tZ)(s.l.SubmitButton,{block:!1,isDisabled:!R,localizationKey:(0,C.u1)("createOrganization.formButtonSubmit")}),t.onCancel&&(0,a.tZ)(s.l.ResetButton,{localizationKey:(0,C.u1)("userProfile.formButtonReset"),block:!1,onClick:t.onCancel})]})]})}),(0,a.tZ)(d.Y,{headerTitle:(0,C.u1)("organizationProfile.invitePage.title"),headerTitleTextVariant:"h2",headerSubtitleTextVariant:W,sx:t=>({minHeight:t.sizes.$60,textAlign:"left"}),children:O&&(0,a.tZ)(S.l,{resetButtonLabel:(0,C.u1)("createOrganization.invitePage.formButtonReset"),onSuccess:w.nextStep,onReset:X})}),(0,a.BX)(Z.Col,{children:[(0,a.tZ)(u.h.Root,{children:(0,a.tZ)(u.h.Title,{localizationKey:(0,C.u1)("organizationProfile.invitePage.title"),sx:{textAlign:"left"}})}),(0,a.tZ)(h.I,{contents:(0,a.tZ)(x.a,{}),sx:t=>({minHeight:t.sizes.$60}),onFinish:X})]})]})})},30683:function(t,e,i){i.r(e),i.d(e,{OrganizationList:()=>E});var a=i(73312),n=i(11576),o=i(64204),r=i(24676);i(65223);var l=i(83799),s=i(69144),c=i(20237),d=i(42305),u=i(92418),g=i(2672),h=i(92654),p=i(76028),z=i(96519),v=i(91816);let m=t=>(0,a.tZ)(c.o2,{elementDescriptor:o.descriptors.organizationListPreviewItems,...t}),Z=t=>(0,a.tZ)(c.ij,{elementId:"organizationList",elementDescriptor:o.descriptors.organizationListPreviewItem,...t}),b=t=>(0,a.tZ)(c.De,{elementDescriptor:o.descriptors.organizationListPreviewItemActionButton,...t}),C=t=>(0,a.tZ)(c.Td,{elementDescriptor:o.descriptors.organizationListPreviewButton,...t});var S=i(88870),x=i(57484),f=i(29325),_=i(35973),L=i(62915);let w=t=>{let{user:e}=(0,l.aF)(),i=(0,g.useCardState)(),{navigateAfterSelectOrganization:r}=(0,n.useOrganizationListContext)(),{t:s}=(0,o.useLocalizations)(),{isLoaded:d,setActive:u}=(0,l.eW)();return d?(0,a.tZ)(C,{onClick:()=>{let a;return a=t.organization,i.runAsync(async()=>{try{await u({organization:a}),await r(a)}catch(a){var t,n;if(!(0,f.kD)(a))return void(0,S.S3)(a,[],i.setError);switch(null==(n=a.errors)||null==(t=n[0])?void 0:t.code){case"organization_not_found_or_unauthorized":case"not_a_member_in_organization":(null==e?void 0:e.createOrganizationEnabled)?i.setError(s((0,o.localizationKeys)("unstable__errors.organization_not_found_or_unauthorized"))):i.setError(s((0,o.localizationKeys)("unstable__errors.organization_not_found_or_unauthorized_with_create_organization_disabled")));break;default:(0,S.S3)(a,[],i.setError)}}})},children:(0,a.tZ)(_.Z,{elementId:"organizationList",mainIdentifierSx:c.fq,organization:t.organization})}):null},y=(0,g.withCardStateProvider)(()=>{let t=(0,g.useCardState)(),{hidePersonal:e,navigateAfterSelectPersonal:i}=(0,n.useOrganizationListContext)(),{isLoaded:r,setActive:s}=(0,l.eW)(),{user:d}=(0,l.aF)();if(!d)return null;let{username:u,primaryEmailAddress:h,primaryPhoneNumber:p,...z}=d;return e?null:(0,a.tZ)(C,{onClick:()=>{if(r)return t.runAsync(async()=>{await s({organization:null}),await i(d)})},children:(0,a.tZ)(L.g,{user:z,mainIdentifierSx:c.fq,title:(0,o.localizationKeys)("organizationSwitcher.personalWorkspace")})})}),$={infinite:!0},P={infinite:!0},k={infinite:!0,status:["pending","accepted"]},A=t=>{let e=(0,g.useCardState)();return(0,a.tZ)(b,{isLoading:e.isLoading,onClick:t.onAccept,localizationKey:(0,o.localizationKeys)("organizationList.action__invitationAccept")})},O=(0,g.withCardStateProvider)(t=>{let e=(0,g.useCardState)(),{getOrganization:i}=(0,l.cL)(),[n,o]=(0,s.useState)(null),{userInvitations:r}=(0,l.eW)({userInvitations:P,userMemberships:$});return n?(0,a.tZ)(w,{organization:n}):(0,a.tZ)(Z,{organizationData:t.publicOrganizationData,children:(0,a.tZ)(A,{onAccept:()=>e.runAsync(async()=>[await t.accept(),await i(t.publicOrganizationData.id)]).then(t=>{var e;let[i,a]=t;null==r||null==(e=r.setData)||e.call(r,t=>(0,x.Sz)(i,t,"negative")),o(a)}).catch(t=>(0,S.S3)(t,[],e.setError))})})}),B=t=>{let e=(0,g.useCardState)(),{userSuggestions:i}=(0,l.eW)({userSuggestions:k});return"accepted"===t.status?(0,a.tZ)(o.Text,{colorScheme:"secondary",localizationKey:(0,o.localizationKeys)("organizationList.suggestionsAcceptedLabel")}):(0,a.tZ)(b,{isLoading:e.isLoading,onClick:()=>e.runAsync(t.accept).then(t=>{var e;return null==i||null==(e=i.setData)?void 0:e.call(i,e=>(0,x.Sz)(t,e))}).catch(t=>(0,S.S3)(t,[],e.setError)),localizationKey:(0,o.localizationKeys)("organizationList.action__suggestionsAccept")})},D=(0,g.withCardStateProvider)(t=>(0,a.tZ)(Z,{organizationData:t.publicOrganizationData,children:(0,a.tZ)(B,{...t})})),I=t=>{let{onCreateOrganizationClick:e}=t,{user:i}=(0,l.aF)();return(null==i?void 0:i.createOrganizationEnabled)?(0,a.tZ)(d.aU,{elementDescriptor:o.descriptors.organizationListCreateOrganizationActionButton,icon:z.mm,label:(0,o.localizationKeys)("organizationList.action__createOrganization"),onClick:e,sx:t=>({borderTopWidth:t.borderWidths.$normal,borderTopStyle:t.borderStyles.$solid,borderTopColor:t.colors.$borderAlpha100,padding:"".concat(t.space.$5," ").concat(t.space.$5)}),iconSx:t=>({width:t.sizes.$9,height:t.sizes.$6})}):null},T=(0,g.withCardStateProvider)(()=>{let{userMemberships:t,userSuggestions:e,userInvitations:i}=(0,p.H)(),r=(null==t?void 0:t.isLoading)||(null==i?void 0:i.isLoading)||(null==e?void 0:e.isLoading),l=!!((null==t?void 0:t.count)||(null==i?void 0:i.count)||(null==e?void 0:e.count)),{hidePersonal:s}=(0,n.useOrganizationListContext)();return(0,a.BX)(u.Z.Root,{children:[(0,a.BX)(u.Z.Content,{sx:t=>({padding:"".concat(t.space.$8," ").concat(t.space.$none," ").concat(t.space.$none)}),children:[r&&(0,a.tZ)(o.Flex,{direction:"row",align:"center",justify:"center",sx:t=>({height:"100%",minHeight:t.sizes.$60}),children:(0,a.tZ)(o.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:o.descriptors.spinner})}),!r&&(0,a.tZ)(K,{showListInitially:!(s&&!l)})]}),(0,a.tZ)(u.Z.Footer,{})]})}),K=t=>{let{showListInitially:e}=t,i=(0,g.useCardState)(),{navigateAfterCreateOrganization:r,skipInvitationScreen:l,hideSlug:c}=(0,n.useOrganizationListContext)(),[d,h]=(0,s.useState)(!e);return(0,a.BX)(a.HY,{children:[!d&&(0,a.tZ)(R,{onCreateOrganizationClick:()=>h(!0)}),d&&(0,a.BX)(a.HY,{children:[(0,a.tZ)(u.Z.Alert,{sx:t=>({margin:"".concat(t.space.$none," ").concat(t.space.$5)}),children:i.error}),(0,a.tZ)(o.Box,{sx:t=>({padding:"".concat(t.space.$none," ").concat(t.space.$5," ").concat(t.space.$5)}),children:(0,a.tZ)(v.$,{flow:"organizationList",startPage:{headerTitle:(0,o.localizationKeys)("organizationList.createOrganization")},skipInvitationScreen:l,navigateAfterCreateOrganization:t=>r(t).then(()=>h(!1)),onCancel:e&&d?()=>h(!1):void 0,hideSlug:c})})]})]})},R=t=>{var e,i,r;let l=(0,g.useCardState)(),s=(0,n.useEnvironment)(),{ref:z,userMemberships:v,userSuggestions:Z,userInvitations:b}=(0,p.H)(),{hidePersonal:C}=(0,n.useOrganizationListContext)(),S=(null==v?void 0:v.isLoading)||(null==b?void 0:b.isLoading)||(null==Z?void 0:Z.isLoading),x=(null==v?void 0:v.hasNextPage)||(null==b?void 0:b.hasNextPage)||(null==Z?void 0:Z.hasNextPage),f=null==(e=b.data)?void 0:e.filter(t=>!!t),_=null==(i=Z.data)?void 0:i.filter(t=>!!t);return(0,a.BX)(a.HY,{children:[(0,a.BX)(h.h.Root,{sx:t=>({padding:"".concat(t.space.$none," ").concat(t.space.$8)}),children:[(0,a.tZ)(h.h.Title,{localizationKey:(0,o.localizationKeys)(C?"organizationList.titleWithoutPersonal":"organizationList.title")}),(0,a.tZ)(h.h.Subtitle,{localizationKey:(0,o.localizationKeys)("organizationList.subtitle",{applicationName:s.displayConfig.applicationName})})]}),(0,a.tZ)(u.Z.Alert,{sx:t=>({margin:"".concat(t.space.$none," ").concat(t.space.$5)}),children:l.error}),(0,a.tZ)(o.Col,{elementDescriptor:o.descriptors.main,children:(0,a.tZ)(m,{children:(0,a.BX)(d.eX,{role:"menu",children:[(0,a.tZ)(y,{}),(v.count||0)>0&&(null==(r=v.data)?void 0:r.map(t=>(0,a.tZ)(w,{...t},t.id))),!v.hasNextPage&&(null==f?void 0:f.map(t=>(0,a.tZ)(O,{...t},t.id))),!v.hasNextPage&&!b.hasNextPage&&(null==_?void 0:_.map(t=>(0,a.tZ)(D,{...t},t.id))),(x||S)&&(0,a.tZ)(c.pr,{ref:z}),(0,a.tZ)(I,{onCreateOrganizationClick:()=>{l.setError(void 0),t.onCreateOrganizationClick()}})]})})})]})},F=(0,n.withCoreUserGuard)(T),E=()=>(0,a.tZ)(o.Flow.Root,{flow:"organizationList",children:(0,a.tZ)(o.Flow.Part,{children:(0,a.tZ)(r.Switch,{children:(0,a.tZ)(r.Route,{children:(0,a.tZ)(F,{})})})})})}}]);